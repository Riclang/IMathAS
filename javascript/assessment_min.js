var closetimer=0,ddmenuitem=0,homemenuloaded=0;function mopen(a,b){"homemenu"==a&&0==homemenuloaded&&(basicahah(imasroot+"/gethomemenu.php?cid="+b,"homemenu"),homemenuloaded=1);mcancelclosetime();ddmenuitem?(ddmenuitem.style.visibility="hidden",ddmenuitem=null):(ddmenuitem=document.getElementById(a),ddmenuitem.style.visibility="visible")}function mclose(){ddmenuitem&&(ddmenuitem.style.visibility="hidden",ddmenuitem=null)}function mclosetime(){closetimer=window.setTimeout(mclose,250)}
function mcancelclosetime(){closetimer&&(window.clearTimeout(closetimer),closetimer=null)}function basicahah(a,b,c){null==c&&(c=" Fetching data... ");document.getElementById(b).innerHTML=c;c=!1;window.XMLHttpRequest?(req=new XMLHttpRequest,c=!0):window.ActiveXObject&&(req=new ActiveXObject("Microsoft.XMLHTTP"),c=!0);c&&(req.onreadystatechange=function(){basicahahDone(a,b)},req.open("GET",a,!0),req.send(""))}
function basicahahDone(a,b){4==req.readyState&&(200==req.status?document.getElementById(b).innerHTML=req.responseText:document.getElementById(b).innerHTML=" AHAH Error:\n"+req.status+"\n"+req.statusText)}function arraysearch(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return c;return-1}var tipobj=0,curtipel=null;
function tipshow(a,b){"object"!=typeof tipobj&&(tipobj=document.createElement("div"),tipobj.className="tips",tipobj.setAttribute("role","tooltip"),tipobj.id="hovertipsholder",document.getElementsByTagName("body")[0].appendChild(tipobj));curtipel=a;a.hasAttribute("data-tip")?tipobj.innerHTML=a.getAttribute("data-tip"):tipobj.innerHTML=b;tipobj.style.left="5px";tipobj.style.display="block";tipobj.setAttribute("aria-hidden","false");a.setAttribute("aria-describedby","hovertipsholder");"undefined"!=typeof usingASCIIMath&&
"undefined"!=typeof noMathRender&&usingASCIIMath&&!noMathRender&&rendermathnode(tipobj);var c=findPos(a);self.innerHeight?x=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?x=document.documentElement.clientWidth:document.body&&(x=document.body.clientWidth);var d=0;"number"==typeof window.pageYOffset?d=window.pageXOffset:document.body&&(document.body.scrollLeft||document.body.scrollTop)?d=document.body.scrollLeft:document.documentElement&&(document.documentElement.scrollLeft||
document.documentElement.scrollTop)&&(d=document.documentElement.scrollLeft);x+=d;c[0]+tipobj.offsetWidth>x-10&&(c[0]=x-tipobj.offsetWidth-30);tipobj.style.left=c[0]+20+"px";tipobj.style.top=30>c[1]?c[1]+20+"px":c[1]-tipobj.offsetHeight+"px"}var popupwins=[];
function popupwindow(a,b,c,d,e){"fit"==d&&(d=window.height-80);c="width="+c+",height="+d+",status=0,resizable=1,directories=0,menubar=0";null!=e&&1==e&&(c+=",scrollbars=1");"undefined"==typeof popupwins[a]||popupwins[a].closed||popupwins[a].focus();b.match(/^http/)?popupwins[a]=window.open(b,a,c):(e=window.open("",a,c),e.document.write("<html><head><title>Popup</title></head><body>"),e.document.write(b),e.document.write("</body></html>"),e.document.close(),popupwins[a]=e)}
function tipout(a){tipobj.style.display="none";tipobj.setAttribute("aria-hidden","true");curtipel&&curtipel.removeAttribute("aria-describedby");curtipel=null}function findPos(a){var b=curtop=0;if(a.offsetParent){do b+=a.offsetLeft,curtop+=a.offsetTop,a.offsetParent&&(a.parentNode&&a.offsetParent!=a.parentNode?(b-=a.parentNode.scrollLeft,curtop-=a.parentNode.scrollTop):(b-=a.offsetParent.scrollLeft,curtop-=a.offsetParent.scrollTop));while(a=a.offsetParent)}return[b,curtop]}
function togglepic(a){a.getAttribute("src").match("userimg_sm")?a.setAttribute("src",a.getAttribute("src").replace("_sm","_")):a.setAttribute("src",a.getAttribute("src").replace("_","_sm"))}function addLoadEvent(a){var b=window.onload;window.onload="function"!=typeof window.onload?a:function(){b&&b();a()}}
function submitlimiter(a){var b=a.target;"submitted"==b.className?(alert("You have already submitted this page.  Please be patient while your submission is processed."),b.className="submitted2",a.preventDefault?a.preventDefault():a.returnValue=!1):"submitted2"==b.className?a.preventDefault?a.preventDefault():a.returnValue=!1:b.className="submitted"}
function setupFormLimiters(){for(var a=document.getElementsByTagName("form"),b=0;b<a.length;b++)if("function"!=typeof a[b].onsubmit&&"nolimit"!=a[b].className)$(a[b]).on("submit",submitlimiter)}addLoadEvent(setupFormLimiters);var GB_loaded=!1;
function GB_show(a,b,c,d){if(0==GB_loaded){var e=document.createElement("div");e.id="GB_overlay";e.onclick=GB_hide;document.getElementsByTagName("body")[0].appendChild(e);e=document.createElement("div");e.setAttribute("aria-role","dialog");e.setAttribute("aria-labelledby","GB_caption");e.setAttribute("tabindex",-1);e.id="GB_window";e.innerHTML='<div id="GB_caption"></div><div id="GB_loading">Loading...</div><div id="GB_frameholder" ></div>';document.getElementsByTagName("body")[0].appendChild(e);
GB_loaded=!0}document.getElementById("GB_frameholder").innerHTML='<iframe onload="GB_doneload()" id="GB_frame" src="'+b+'"></iframe>';jQuery("#GB_frameholder").isolatedScroll();b.match(/libtree/)?(document.getElementById("GB_caption").innerHTML='<span class="floatright"><input type="button" value="Use Libraries" onClick="document.getElementById(\'GB_frame\').contentWindow.setlib()" /> <a href="#" class="pointer" onclick="GB_hide();return false;" aria-label="Close">[X]</a>&nbsp;</span>Select Libraries<div class="clear"></div>',
a=self.innerHeight||de&&de.clientHeight||document.body.clientHeight):(document.getElementById("GB_caption").innerHTML='<span class="floatright"><a href="#" class="pointer" onclick="GB_hide();return false;" aria-label="Close">[X]</a></span>'+a,document.getElementById("GB_caption").onclick=GB_hide,a="auto"==d?self.innerHeight||de&&de.clientHeight||document.body.clientHeight:d);document.getElementById("GB_window").style.display="block";document.getElementById("GB_overlay").style.display="block";document.getElementById("GB_loading").style.display=
"block";b=$(document).width();c>b-20&&(c=b-20);document.getElementById("GB_window").style.width=c+"px";document.getElementById("GB_window").style.height=a-30+"px";document.getElementById("GB_frame").style.height=a-30-34+"px";document.getElementById("GB_window").focus();$(document).on("keydown.GB",function(a){27==a.keyCode&&GB_hide()})}function GB_doneload(){document.getElementById("GB_loading").style.display="none"}
function GB_hide(){document.getElementById("GB_window").style.display="none";document.getElementById("GB_overlay").style.display="none";$(document).off("keydown.GB")}function chkAllNone(a,b,c,d){a=document.getElementById(a);for(i=0;i<=a.elements.length;i++)try{if("all"==b&&"checkbox"==a.elements[i].type||a.elements[i].name==b)a.elements[i].checked=d&&a.elements[i].className==d?!c:c}catch(e){}return!1}var tinyMCEPreInit={base:imasroot+"/tinymce4"};
function initeditor(a,b,c,d,e){c=c||0;d=d||0;var f="";"exact"==a?f="#"+b.split(/,/).join(",#"):"textareas"==a?f="textarea."+b:"divs"==a?f="div."+b:"selector"==a&&(f=b);a={selector:f,inline:d,plugins:["lists advlist autolink attach image charmap anchor","searchreplace code link textcolor","media table paste asciimath asciisvg rollups colorpicker"],menubar:!1,toolbar1:"myEdit myInsert styleselect | bold italic underline subscript superscript | forecolor backcolor | code | saveclose",toolbar2:" alignleft aligncenter alignright | bullist numlist outdent indent  | attach link unlink image | table | asciimath asciimathcharmap asciisvg",
extended_valid_elements:"iframe[src|width|height|name|align|allowfullscreen|frameborder],param[name|value],@[sscr]",content_css:imasroot+(1==c?"/assessment/mathtest.css,":"/imascore.css,")+imasroot+"/themes/"+coursetheme,AScgiloc:imasroot+"/filter/graph/svgimg.php",convert_urls:!1,file_picker_callback:filePickerCallBackFunc,file_browser_types:"file image",images_upload_url:imasroot+"/tinymce4/upload_handler.php",paste_data_images:!0,paste_webkit_styles:"color font-size text-decoration",default_link_target:"_blank",
browser_spellcheck:!0,branding:!1,resize:"both",width:"100%",content_style:"body {background-color: #ffffff !important;}",table_class_list:[{title:"None",value:""},{title:"Gridded",value:"gridded"},{title:"Gridded Centered",value:"gridded centered"}],style_formats_merge:!0,style_formats:[{title:"Font Family",items:[{title:"Arial",inline:"span",styles:{"font-family":"arial"}},{title:"Book Antiqua",inline:"span",styles:{"font-family":"book antiqua"}},{title:"Comic Sans MS",inline:"span",styles:{"font-family":"comic sans ms,sans-serif"}},
{title:"Courier New",inline:"span",styles:{"font-family":"courier new,courier"}},{title:"Georgia",inline:"span",styles:{"font-family":"georgia,palatino"}},{title:"Helvetica",inline:"span",styles:{"font-family":"helvetica"}},{title:"Impact",inline:"span",styles:{"font-family":"impact,chicago"}},{title:"Open Sans",inline:"span",styles:{"font-family":"Open Sans"}},{title:"Symbol",inline:"span",styles:{"font-family":"symbol"}},{title:"Tahoma",inline:"span",styles:{"font-family":"tahoma"}},{title:"Terminal",
inline:"span",styles:{"font-family":"terminal,monaco"}},{title:"Times New Roman",inline:"span",styles:{"font-family":"times new roman,times"}},{title:"Verdana",inline:"span",styles:{"font-family":"Verdana"}}]},{title:"Font Size",items:[{title:"x-small",inline:"span",styles:{fontSize:"x-small","font-size":"x-small"}},{title:"small",inline:"span",styles:{fontSize:"small","font-size":"small"}},{title:"medium",inline:"span",styles:{fontSize:"medium","font-size":"medium"}},{title:"large",inline:"span",
styles:{fontSize:"large","font-size":"large"}},{title:"x-large",inline:"span",styles:{fontSize:"x-large","font-size":"x-large"}},{title:"xx-large",inline:"span",styles:{fontSize:"xx-large","font-size":"xx-large"}}]}]};385>document.documentElement.clientWidth?(a.toolbar1="myEdit myInsert styleselect | bold italic underline | saveclose",a.toolbar2="bullist numlist outdent indent  | link image | asciimath asciisvg"):465>document.documentElement.clientWidth?(a.toolbar1="myEdit myInsert styleselect | bold italic underline forecolor | saveclose",
a.toolbar2="bullist numlist outdent indent  | link unlink image | asciimath asciisvg"):575>document.documentElement.clientWidth&&(a.toolbar1="myEdit myInsert styleselect | bold italic underline subscript superscript | forecolor | saveclose",a.toolbar2=" alignleft aligncenter | bullist numlist outdent indent  | link unlink image | asciimath asciimathcharmap asciisvg");e&&(a.setup=e);for(var h in tinymce.editors)tinymce.editors[h].remove();tinymce.init(a)}
function filePickerCallBack(a,b,c){b=imasroot+"/tinymce4/file_manager.php";switch(c.filetype){case "image":b+="?type=img";break;case "file":b+="?type=files"}tinyMCE.activeEditor.windowManager.open({file:b,title:"File Manager",width:350,height:450,resizable:"yes",inline:"yes",close_previous:"no"},{oninsert:function(b,c){a(b)}})}
function imascleanup(a,b){"get_from_editor"==a&&(b=b.replace(/\x3c!--([\s\S]*?)--\x3e|&lt;!--([\s\S]*?)--&gt;|<style>[\s\S]*?<\/style>/g,""),b=b.replace(/class="?Mso\w+"?/g,""),b=b.replace(/<p\s*>\s*<\/p>/gi,""),b=b.replace(/<script.*?\/script>/gi,""),b=b.replace(/<input[^>]*button[^>]*>/gi,""));return b}
function readCookie(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return unescape(d.substring(a.length,d.length))}return null}
function selectByDivID(a){var b=a.value;a=a.value.split(":")[0];for(var c=document.getElementsByTagName("div"),d=0;d<c.length;d++)c[d].className.match(a)&&(c[d].style.display=c[d].id==b?"block":"none");c=new Date;c.setDate(c.getDate()+365);document.cookie=a+"store="+escape(b)+";expires="+c.toGMTString()}
function setselectbycookie(){for(var a=document.getElementsByTagName("select"),b=0;b<a.length;b++)if(a[b].className.match("alts")){var c=a[b].className.replace(/alts/,"").replace(/\s/g,"");null!=(co=readCookie(c+"store"))&&(co=co.replace("store",""),a[b].value=co,selectByDivID(a[b]))}}addLoadEvent(setselectbycookie);var recordedunload=!1;
function recclick(a,b,c,d){if(0<cid){var e="",f;null!==(f=window.location.href.match(/showlinkedtext.*?&id=(\d+)/))&&0==recordedunload&&(e="&unloadinglinked="+f[1],recordedunload=!0);jQuery.ajax({type:"POST",url:imasroot+"/course/rectrack.php?cid="+cid,data:"type="+encodeURIComponent(a)+"&typeid="+encodeURIComponent(b)+"&info="+encodeURIComponent(c+"::"+d)+e})}}
function setuptracklinks(a,b){jQuery(b).attr("data-base")&&jQuery(b).click(function(a){var c=jQuery(this).attr("data-base").split("-");recclick(c[0],c[1],jQuery(this).attr("href"),jQuery(this).text());if("undefined"==typeof jQuery(b).attr("target"))return a.preventDefault(),setTimeout('window.location.href = "'+jQuery(this).attr("href")+'"',100),!1}).mousedown(function(a){3==a.which&&(a=jQuery(this).attr("data-base").split("-"),recclick(a[0],a[1],jQuery(this).attr("href"),jQuery(this).text()))})}
var videoembedcounter=0;
function togglevideoembed(){var a=this.id.substr(13),b=jQuery("#videoiframe"+a);if(0<b.length)"none"==b.css("display")?(b.show(),b.parent(".fluid-width-video-wrapper").show(),jQuery(this).text(" [-]"),jQuery(this).attr("title",_("Hide video"))):(b.hide(),b.get(0).contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),b.parent(".fluid-width-video-wrapper").hide(),jQuery(this).text(" [+]"),jQuery(this).attr("title",_("Watch video here")));else{b=jQuery(this).prev().attr("href");var c=
"?";if(b.match(/youtube\.com/))if(-1<b.indexOf("playlist?list=")){var d=b.split("list=")[1].split(/[#&]/)[0];var e="www.youtube.com/embed/videoseries?list=";c="&"}else d=b.split("v=")[1].split(/[#&]/)[0],e="www.youtube.com/embed/";else b.match(/youtu\.be/)?(d=b.split(".be/")[1].split(/[#&]/)[0],e="www.youtube.com/embed/"):b.match(/vimeo/)&&(d=b.split(".com/")[1].split(/[#&]/)[0],e="player.vimeo.com/video/");var f=b.match(/.*\Wt=((\d+)m)?((\d+)s)?.*/);null==f?(c+="rel=0",f=b.match(/.*start=(\d+)/),
null!=f&&(c+="&start="+f[1])):c=c+"rel=0&start="+((f[2]?60*f[2]:0)+(f[4]?1*f[4]:0));f=b.match(/.*end=(\d+)/);null!=f&&(c+="&end="+f[1]);jQuery("<iframe/>",{id:"videoiframe"+a,width:640,height:400,src:location.protocol+"//"+e+d+(c+"&enablejsapi=1"),frameborder:0,allowfullscreen:1}).insertAfter(jQuery(this));jQuery(this).parent().fitVids();jQuery("<br/>").insertAfter(jQuery(this));jQuery(this).text(" [-]");jQuery(this).attr("title",_("Hide video"));jQuery(this).prev().attr("data-base")&&(e=jQuery(this).prev().attr("data-base").split("-"),
recclick(e[0],e[1],b,jQuery(this).prev().text()))}}function setupvideoembeds(a,b){jQuery("<span/>",{text:" [+]",title:_("Watch video here"),id:"videoembedbtn"+videoembedcounter,click:togglevideoembed,"class":"videoembedbtn"}).insertAfter(b);videoembedcounter++}function addNoopener(a,b){!b.rel&&b.target&&b.host!==window.location.host&&b.setAttribute("rel","noopener noreferrer")}
function addmultiselect(a,b){var c=jQuery(a).parent(),d=jQuery("#"+b).val(),e=jQuery("#"+b+" option[value="+d+"]").prop("disabled",!0).html();"null"!=d&&c.append('<div class="multiselitem"><span class="right"><a href="#" onclick="removemultiselect(this);return false;">Remove</a></span><input type="hidden" name="'+b+'[]" value="'+d+'"/>'+e+"</div>");jQuery("#"+b).val("null")}
function removemultiselect(a){a=jQuery(a).parent().parent();var b=a.find("input").val();a.parent().find("option[value="+b+"]").prop("disabled",!1);a.remove()}function hidefromcourselist(a,b,c){confirm("Are you SURE you want to hide this course from your course list?")&&jQuery.ajax({type:"GET",url:imasroot+"/admin/hidefromcourselist.php?cid="+b+"&type="+c}).done(function(b){"OK"==b&&(jQuery(a).closest("ul.courselist > li").slideUp(),jQuery("#unhidelink"+c).show())});return!1}
function rotateimg(a){var b=$(a).data("rotation")?($(a).data("rotation")+90)%360:90;$(a).data("rotation",b).css({transform:"rotate("+b+"deg)"});90==b%180?(b=($(a).width()-$(a).height())/2,0<b&&$(a).parent().css({"padding-top":b,"padding-bottom":b})):$(a).parent().css({"padding-top":0,"padding-bottom":0})}
jQuery(document).ready(function(a){a(window).on("message",function(b){if(b.originalEvent.data.match(/lti\.frameResize/))for(var c=JSON.parse(b.originalEvent.data),d=document.getElementsByTagName("iframe"),e=0;e<d.length;e++)if(d[e].contentWindow===b.originalEvent.source){a(d[e]).height(c.height);break}})});jQuery(document).ready(function(a){a("a").each(setuptracklinks).each(addNoopener);a('a[href*="youtu"]').each(setupvideoembeds);a('a[href*="vimeo"]').each(setupvideoembeds);a("body").fitVids()});
jQuery.fn.isolatedScroll=function(){this.bind("mousewheel DOMMouseScroll",function(a){var b=a.wheelDelta||a.originalEvent&&a.originalEvent.wheelDelta||-a.detail,c=0<=this.scrollTop+jQuery(this).outerHeight()-this.scrollHeight,d=0>=this.scrollTop;(0>b&&c||0<b&&d)&&a.preventDefault()});return this};
jQuery(document).ready(function(a){for(var b=a(".fixedonscroll"),c=[],d=0;d<b.length;d++)c[d]=a(b[d]).offset().top,a(b[d]).height()>a(window).height()&&(c[d]=-1);0<b.length&&"left"==a(b[0]).css("float")&&a(window).scroll(function(){for(var d=a(window).scrollTop(),f=0;f<b.length;f++)d>c[f]&&0<c[f]?a(b[f]).css("position","fixed").css("top","5px"):a(b[f]).css("position","static")})});
function _(a){var b="undefined"!=typeof i18njs&&i18njs[a]?i18njs[a]:a;if(1<arguments.length)for(var c=1;c<arguments.length;c++)b=b.replace("$"+c,arguments[c]);return b}
(function(a){a.fn.fitVids=function(){return this.each(function(){a(this).find("iframe[src*='player.vimeo.com'],iframe[src*='youtube.com'],iframe[src*='youtube-nocookie.com']").each(function(){var b=a(this);if(0<b.closest(".textsegment").length)return!0;b.parentsUntil(".intro","table").each(function(){a(this).css("width","100%")});var c=b.attr("height")&&!isNaN(parseInt(b.attr("height"),10))?parseInt(b.attr("height"),10):b.height(),d=isNaN(parseInt(b.attr("width"),10))?b.width():parseInt(b.attr("width"),
10);c/=d;b.attr("id")||b.attr("id","fitvid"+Math.floor(999999*Math.random()));b.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*c+"%").wrap('<div class="video-wrapper-wrapper"></div>').parent(".video-wrapper-wrapper").css("max-width",d+"px");b.removeAttr("height").removeAttr("width").css("height","").css("width","")})})}})(window.jQuery||window.Zepto);
function setAltSelectors(a,b){console.log("looking for "+a);$(".alts."+a).parents(".altWrap").find(".altContentOn").removeClass("altContentOn").addClass("altContentOff");$(".alts."+a).parents(".altWrap").find("."+b).addClass("altContentOn").removeClass("altContentOff");$("select.alts."+a).val(a+":"+b);var c=new Date;c.setDate(c.getDate()+365);document.cookie="alt_store_"+a+"="+escape(b)+";expires="+c.toGMTString()+";path=/"}
jQuery(document).ready(function(a){a(".alts").on("change",function(){var a=this.value.split(":");1<a.length&&setAltSelectors(a[0],a[1])}).each(function(b,c){var d=c.value.split(":");null!=(co=readCookie("alt_store_"+d[0]))?setAltSelectors(d[0],co):a(c).hasClass("setDefault")&&setAltSelectors(d[0],d[1])});a(document).on("keydown",function(b){8!==b.which||a(b.target).is("input[type='text']:not([readonly]),input:not([type]):not([readonly]),input[type='password']:not([readonly]), textarea, [contenteditable='true']")||
b.preventDefault()});a("div.breadcrumb").attr("role","navigation").attr("aria-label",_("Navigation breadcrumbs"));a("div.cpmid,div.cp").attr("role","group").attr("aria-label",_("Control link group"));a("#centercontent").length&&(a("#centercontent").attr("role","main"),a(".midwrapper").removeAttr("role"))});
jQuery(document).ready(function(a){function b(b){var c=a("#headermobilemenulist");"true"==c.attr("aria-hidden")?(a("#headermobilemenulist").slideDown(50,function(){a("#headermobilemenulist").addClass("menuexpanded").removeAttr("style");c.attr("aria-hidden",!1);a("#topnavmenu").attr("aria-expanded",!0)}),a("#navlist").slideDown(100,function(){a("#navlist").addClass("menuexpanded").removeAttr("style")})):(a("#navlist").slideUp(100,function(){a("#navlist").removeClass("menuexpanded").removeAttr("style")}),
a("#headermobilemenulist").slideUp(50,function(){a("#headermobilemenulist").removeClass("menuexpanded").removeAttr("style");c.attr("aria-hidden",!0);a("#topnavmenu").attr("aria-expanded",!1)}));b.preventDefault()}a("#topnavmenu").on("click",b).on("keydown",function(a){13!==a.which&&32!=a.which||b(a)})});
+function(a){function b(b){var c=b.attr("data-target");c||(c=(c=b.attr("href"))&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));return(c=c&&a(c))&&c.length?c:b.parent()}function c(c){c&&3===c.which||(a(".dropdown-backdrop").remove(),a('[data-toggle="dropdown"]').each(function(){var d=a(this),f=b(d),e={relatedTarget:this};!f.hasClass("open")||c&&"click"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(f[0],c.target)||(f.trigger(c=a.Event("hide.bs.dropdown",e)),c.isDefaultPrevented()||
(d.attr("aria-expanded","false"),f.removeClass("open").trigger("hidden.bs.dropdown",e)))}))}var d=function(b){a(b).on("click.bs.dropdown",this.toggle)};d.VERSION="3.3.5";d.prototype.toggle=function(d){var f=a(this);if(!f.is(".disabled, :disabled")){var e=b(f);d=e.hasClass("open");c();if(!d){if("ontouchstart"in document.documentElement&&!e.closest(".navbar-nav").length)a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",c);var g={relatedTarget:this};e.trigger(d=
a.Event("show.bs.dropdown",g));if(d.isDefaultPrevented())return;f.trigger("focus").attr("aria-expanded","true");e.toggleClass("open").trigger("shown.bs.dropdown",g)}return!1}};d.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var d=a(this);c.preventDefault();c.stopPropagation();if(!d.is(".disabled, :disabled")){var e=b(d),f=e.hasClass("open");if(!f&&27!=c.which||f&&27==c.which)return 27==c.which&&e.find('[data-toggle="dropdown"]').trigger("focus"),
d.trigger("click");d=e.find(".dropdown-menu li:not(.disabled):visible a");d.length&&(e=d.index(c.target),38==c.which&&0<e&&e--,40==c.which&&e<d.length-1&&e++,~e||(e=0),d.eq(e).trigger("focus"))}}};var e=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),e=c.data("bs.dropdown");e||c.data("bs.dropdown",e=new d(this));"string"==typeof b&&e[b].call(c)})};a.fn.dropdown.Constructor=d;a.fn.dropdown.noConflict=function(){a.fn.dropdown=e;return this};a(document).on("click.bs.dropdown.data-api",
c).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",'[data-toggle="dropdown"]',d.prototype.toggle).on("keydown.bs.dropdown.data-api",'[data-toggle="dropdown"]',d.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",d.prototype.keydown)}(jQuery);

var pi=Math.PI,ln=Math.log,e=Math.E,arcsin=Math.asin,arccos=Math.acos,arctan=Math.atan,sec=function(a){return 1/Math.cos(a)},csc=function(a){return 1/Math.sin(a)},cot=function(a){return 1/Math.tan(a)},arcsec=function(a){return arccos(1/a)},arccsc=function(a){return arcsin(1/a)},arccot=function(a){return arctan(1/a)},sinh=function(a){return(Math.exp(a)-Math.exp(-a))/2},cosh=function(a){return(Math.exp(a)+Math.exp(-a))/2},tanh=function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))},
sech=function(a){return 1/cosh(a)},csch=function(a){return 1/sinh(a)},coth=function(a){return 1/tanh(a)},arcsinh=function(a){return ln(a+Math.sqrt(a*a+1))},arccosh=function(a){return ln(a+Math.sqrt(a*a-1))},arctanh=function(a){return ln((1+a)/(1-a))/2};sech=function(a){return 1/cosh(a)};csch=function(a){return 1/sinh(a)};coth=function(a){return 1/tanh(a)};
var arcsech=function(a){return arccosh(1/a)},arccsch=function(a){return arcsinh(1/a)},arccoth=function(a){return arctanh(1/a)},sign=function(a){return 0==a?0:0>a?-1:1},logten=function(a){return Math.LOG10E*Math.log(a)},sinn=function(a,c){return Math.pow(Math.sin(c),a)},cosn=function(a,c){return Math.pow(Math.cos(c),a)},tann=function(a,c){return Math.pow(Math.tan(c),a)},cscn=function(a,c){return 1/Math.pow(Math.sin(c),a)},secn=function(a,c){return 1/Math.pow(Math.cos(c),a)},cotn=function(a,c){return 1/
Math.pow(Math.tan(c),a)};function factorial(a,c){null==c&&(c=1);for(var h=a-c;0<h;h-=c)a*=h;return 0>a?NaN:0==a?1:a}function C(a,c){for(var h=1,f=0;f<c;f++)h*=(a-f)/(c-f);return h}function matchtolower(a){return a.toLowerCase()}function nthroot(a,c){return safepow(c,1/a)}function nthlogten(a,c){return Math.log(c)/Math.log(a)}var funcstoindexarr="sinh cosh tanh sech csch coth sqrt ln log sin cos tan sec csc cot abs root arcsin arccos arctan arcsec arccsc arccot arcsinh arccosh arctanh arcsech arccsch arccoth".split(" ");
function functoindex(a){for(var c=0;c<funcstoindexarr.length;c++)if(funcstoindexarr[c]==a)return"@"+c+"@"}function indextofunc(a,c){return funcstoindexarr[c]}function safepow(a,c){if(0>a&&Math.floor(c)!=c){for(var h=3;50>h;h+=2)if(1E-6>Math.abs(Math.round(h*c)-h*c))return 0==Math.round(h*c)%2?Math.pow(Math.abs(a),c):-1*Math.pow(Math.abs(a),c);return Math.sqrt(-1)}return Math.pow(a,c)}
function mathjs(a,c){a=a.replace("[","(");a=a.replace("]",")");a=a.replace(/root\s*(\d+)/,"root($1)");a=a.replace(/\|(.*?)\|/g,"abs($1)");a=a.replace(/arc(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)/gi,"$1^-1");a=a.replace(/(Sin|Cos|Tan|Sec|Csc|Cot|Arc|Abs|Log|Ln|Sqrt)/gi,matchtolower);if(null!=c){var h=c.split("|");a=a.replace(/(sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root)/g,functoindex);var f=RegExp("(sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root)[(]","g");
a=a.replace(f,"$1#(");f=new RegExp("("+c+")("+c+")$","g");a=a.replace(f,"($1)($2)");f=new RegExp("("+c+")(a#|sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root|pi)","g");a=a.replace(f,"($1)$2");f=new RegExp("("+c+")("+c+")([^a-df-zA-Z#])","g");a=a.replace(f,"($1)($2)$3");f=new RegExp("([^a-df-zA-Z#])("+c+")([^a-df-zA-Z#])","g");a=a.replace(f,"$1($2)$3");f=new RegExp("([^a-df-zA-Z#(])("+c+")([^a-df-zA-Z#)])","g");a=a.replace(f,"$1($2)$3");f=new RegExp("^("+c+")([^a-df-zA-Z])","g");a=a.replace(f,"($1)$2");
f=new RegExp("([^a-df-zA-Z])("+c+")$","g");a=a.replace(f,"$1($2)");a=a.replace(new RegExp("\\(("+c+")\\)","g"),function(a,b){for(var c=0;c<h.length;c++)if(h[c]==b)return"(@v"+c+"@)"});a=a.replace(/@(\d+)@/g,indextofunc)}a=a.replace(/([0-9])\s+([0-9])/g,"$1*$2");a=a.replace(/#/g,"");a=a.replace(/\s/g,"");a=a.replace(/log_([a-zA-Z\d\.]+)\(/g,"nthlog($1,");a=a.replace(/log_\(([a-zA-Z\/\d\.]+)\)\(/g,"nthlog($1,");a=a.replace(/log/g,"logten");-1!=a.indexOf("^-1")&&(a=a.replace(/sin\^-1/g,"arcsin"),a=a.replace(/cos\^-1/g,
"arccos"),a=a.replace(/tan\^-1/g,"arctan"),a=a.replace(/sec\^-1/g,"arcsec"),a=a.replace(/csc\^-1/g,"arccsc"),a=a.replace(/cot\^-1/g,"arccot"),a=a.replace(/sinh\^-1/g,"arcsinh"),a=a.replace(/cosh\^-1/g,"arccosh"),a=a.replace(/tanh\^-1/g,"arctanh"),a=a.replace(/sech\^-1/g,"arcsech"),a=a.replace(/csch\^-1/g,"arccsch"),a=a.replace(/coth\^-1/g,"arccoth"));a=a.replace(/(sin|cos|tan|sec|csc|cot)\^(\d+)\(/g,"$1n($2,");a=a.replace(/root\((\d+)\)\(/g,"nthroot($1,");a=a.replace(/([0-9])E([\-0-9])/g,"$1(EE)$2");
a=a.replace(/^e$/g,"(E)");a=a.replace(/pi/g,"(pi)");a=a.replace(/@v(\d+)@/g,function(a,b){return h[b]});a=a.replace(/^e([^a-zA-Z])/g,"(E)$1");a=a.replace(/([^a-zA-Z])e$/g,"$1(E)");a=a.replace(/([^a-zA-Z])e(?=[^a-zA-Z])/g,"$1(E)");a=a.replace(/([0-9])([\(a-zA-Z])/g,"$1*$2");a=a.replace(/(!)([0-9\(])/g,"$1*$2");a=a.replace(/([0-9])\*\(EE\)([\-0-9])/,"$1e$2");a=a.replace(/\)([\(0-9a-zA-Z]|\.\d+)/g,")*$1");for(var d,g,b,k;-1!=(f=a.indexOf("^"));){if(0==f)return"Error: missing argument";d=f-1;b=a.charAt(d);
if("0"<=b&&"9">=b){for(d--;0<=d&&"0"<=(b=a.charAt(d))&&"9">=b;)d--;if("."==b)for(d--;0<=d&&"0"<=(b=a.charAt(d))&&"9">=b;)d--}else if(")"==b){k=1;for(d--;0<=d&&0<k;)b=a.charAt(d),"("==b?k--:")"==b&&k++,d--;for(;0<=d&&("a"<=(b=a.charAt(d))&&"z">=b||"A"<=b&&"Z">=b);)d--}else if("a"<=b&&"z">=b||"A"<=b&&"Z">=b)for(d--;0<=d&&("a"<=(b=a.charAt(d))&&"z">=b||"A"<=b&&"Z">=b);)d--;else return"Error: incorrect syntax in "+a+" at position "+d;if(f==a.length-1)return"Error: missing argument";g=f+1;b=a.charAt(g);
nch=a.charAt(g+1);if("0"<=b&&"9">=b||"-"==b&&"("!=nch||"."==b){for(g++;g<a.length&&"0"<=(b=a.charAt(g))&&"9">=b;)g++;if("."==b)for(g++;g<a.length&&"0"<=(b=a.charAt(g))&&"9">=b;)g++}else if("("==b||"-"==b&&"("==nch)for("-"==b&&g++,k=1,g++;g<a.length&&0<k;)b=a.charAt(g),"("==b?k++:")"==b&&k--,g++;else if("a"<=b&&"z">=b||"A"<=b&&"Z">=b){for(g++;g<a.length&&("a"<=(b=a.charAt(g))&&"z">=b||"A"<=b&&"Z">=b);)g++;if("("==b&&a.slice(f+1,g).match(/^(sin|cos|tan|sec|csc|cot|logten|log|ln|exp|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|sqrt|abs|nthroot)$/))for(k=
1,g++;g<a.length&&0<k;)b=a.charAt(g),"("==b?k++:")"==b&&k--,g++}else return"Error: incorrect syntax in "+a+" at position "+g;a=a.slice(0,d+1)+"safepow("+a.slice(d+1,f)+","+a.slice(f+1,g)+")"+a.slice(g)}for(;-1!=(f=a.indexOf("!"));){if(0==f)return"Error: missing argument";d=f-1;b=a.charAt(d);if("0"<=b&&"9">=b){for(d--;0<=d&&"0"<=(b=a.charAt(d))&&"9">=b;)d--;if("."==b)for(d--;0<=d&&"0"<=(b=a.charAt(d))&&"9">=b;)d--}else if(")"==b){k=1;for(d--;0<=d&&0<k;)b=a.charAt(d),"("==b?k--:")"==b&&k++,d--;for(;0<=
d&&("a"<=(b=a.charAt(d))&&"z">=b||"A"<=b&&"Z">=b);)d--}else if("a"<=b&&"z">=b||"A"<=b&&"Z">=b)for(d--;0<=d&&("a"<=(b=a.charAt(d))&&"z">=b||"A"<=b&&"Z">=b);)d--;else return"Error: incorrect syntax in "+a+" at position "+d;a=a.slice(0,d+1)+"factorial("+a.slice(d+1,f)+")"+a.slice(f+1)}return a};

function updateeeddpos(){}function updateehpos(){}var LivePreviews=[];
function setupLivePreview(a){LivePreviews.hasOwnProperty(a)||("MathJax"==mathRenderer||"Katex"==mathRenderer?(LivePreviews[a]={delay:"MathJax"==mathRenderer?100:20,finaldelay:1E3,preview:null,buffer:null,timeout:null,finaltimeout:null,mjRunning:!1,mjPending:!1,oldText:null,Init:function(){$("#p"+a).css("positive","relative").append('<span id="lpbuf1'+a+'" style="visibility:hidden;position:absolute;"></span>').append('<span id="lpbuf2'+a+'" style="visibility:hidden;position:absolute;"></span>');this.preview=
document.getElementById("lpbuf1"+a);this.buffer=document.getElementById("lpbuf2"+a)},SwapBuffers:function(){var a=this.preview,b=this.buffer;this.buffer=a;this.preview=b;a.style.visibility="hidden";a.style.position="absolute";b.style.position="";b.style.visibility=""},Update:function(a){this.timeout&&clearTimeout(this.timeout);this.finaltimeout&&clearTimeout(this.finaltimeout);this.timeout=setTimeout(this.callback,this.delay);this.finaltimeout=setTimeout(this.DoFinalPreview,this.finaldelay)},RenderNow:function(a){this.buffer.innerHTML=
this.oldtext=a;this.mjRunning=!0;this.RenderBuffer()},RenderBuffer:function(){"MathJax"==mathRenderer?MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.buffer],["PreviewDone",this]):"Katex"==mathRenderer&&(renderMathInElement(this.buffer),0<$(this.buffer).children(".mj").length?MathJax.Hub.Queue(["PreviewDone",this]):this.PreviewDone())},DoFinalPreview:function(){$("#pbtn"+a).trigger("click")},preformat:function(d){if(intcalctoproc.hasOwnProperty(a))calcformat[a].match(/inequality/)?(d=d.replace(/<=/g,
" le ").replace(/>=/g," ge ").replace(/</g," lt ").replace(/>/g," gt "),d.match(/all\s*real/i)&&(d="text("+d+")")):d=d.replace(/U/g,"uu");else if(vlist.hasOwnProperty(a))d=AMnumfuncPrepVar(a,d)[1];else if(calcformat.hasOwnProperty(a)){var b=calcformat[a];-1==b.indexOf("list")&&-1==b.indexOf("set")&&(d=d.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1"))}return d},CreatePreview:function(){this.timeout=null;if(!this.mjPending){var d=null==document.getElementById("tc"+a)?document.getElementById("qn"+a).value:
document.getElementById("tc"+a).value;d!==this.oldtext&&(this.mjRunning?(this.mjPending=!0,MathJax.Hub.Queue(["CreatePreview",this])):(this.oldtext=d,this.buffer.innerHTML="`"+this.preformat(d)+"`",this.mjRunning=!0,this.RenderBuffer()))}},PreviewDone:function(){this.mjRunning=this.mjPending=!1;this.SwapBuffers();updateeeddpos();updateehpos()}},LivePreviews[a].callback=MathJax.Callback(["CreatePreview",LivePreviews[a]]),LivePreviews[a].callback.autoReset=!0,LivePreviews[a].Init()):LivePreviews[a]=
{finaldelay:1E3,finaltimeout:null,Update:function(a){this.finaltimeout&&clearTimeout(this.finaltimeout);this.finaltimeout=setTimeout(this.DoFinalPreview,this.finaldelay)},RenderNow:function(d){var b=document.getElementById("p"+a);b.innerHTML=d;rendermathnode(b)},DoFinalPreview:function(){$("#pbtn"+a).trigger("click")}})}function updateLivePreview(a){a=a.id.substr(2);setupLivePreview(a);LivePreviews[a].Update()}
function normalizemathunicode(a){a=a.replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F]/g,"");a=a.replace(/\u2013|\u2014|\u2015|\u2212/g,"-");a=a.replace(/\u2044|\u2215/g,"/");a=a.replace(/\u221e/g,"oo").replace(/\u2264/g,"<=").replace(/\u2265/g,">=").replace(/\u222a/g,"U");a=a.replace(/\u00b1/g,"+-").replace(/\u00f7/g,"/").replace(/\u00b7|\u2715|\u00d7|\u22c5/g,"*");a=a.replace(/\u221a/g,"sqrt").replace(/\u221b/g,"root(3)");a=a.replace(/\u00b2/g,"^2").replace(/\u00b3/g,"^3");a=a.replace(/\u2080/g,"_0").replace(/\u2081/g,
"_1").replace(/\u2082/g,"_2").replace(/\u2083/g,"_3");a=a.replace(/\bOO\b/i,"oo");a=a.replace(/\u03b8/,"theta").replace(/\u03c6/,"phi").replace(/\u03c0/,"pi").replace(/\u03c3/,"sigma").replace(/\u03bc/,"mu");a=a.replace(/\u03b1/,"alpha").replace(/\u03b2/,"beta").replace(/\u03b3/,"gamma").replace(/\u03b4/,"delta").replace(/\u03b5/,"epsilon").replace(/\u03ba/,"kappa");a=a.replace(/\u03bb/,"lambda").replace(/\u03c1/,"rho").replace(/\u03c4/,"tau").replace(/\u03c7/,"chi").replace(/\u03c9/,"omega");return a=
a.replace(/\u03a9/,"Omega").replace(/\u0393/,"Gamma").replace(/\u03a6/,"Phi").replace(/\u0394/,"Delta").replace(/\u03a3/,"Sigma")}function wrapAMnotice(a){return'<span class="AMHnotice">'+a+"</span>"}
function calculate(a,d,b){var c=document.getElementById(a).value;c=normalizemathunicode(c);c=c.replace(/=/,"");if(-1!=b.indexOf("list"))var f=c.split(/,/);else-1!=b.indexOf("set")?f=c.replace(/[\{\}]/g,"").split(/,/):(f=[],f[0]=c);for(c=0;c<f.length;c++){str=f[c];str=str.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1");var e="";if(str.match(/DNE/i))str=str.toUpperCase();else if(str.match(/oo$/)||str.match(/oo\W/))str="`"+str+"`";else{e+=singlevalsyntaxcheck(str,b);str.match(/,/)&&(e+=_("Invalid use of a comma."));
-1!=b.indexOf("allowxtimes")&&(str=str.replace(/(x|X|\u00D7)/,"*"));-1!=b.indexOf("mixed")?str=str.replace(/_/," "):-1!=b.indexOf("scinot")?str=str.replace(/(x|X|\u00D7)/,"xx"):(str=str.replace(/([0-9])\s+([0-9])/g,"$1*$2"),str=str.replace(/\s/g,""));e+=syntaxcheckexpr(str,b);try{var g=str;g=g.replace(",","*NaN*");g.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(g=g.replace(/%/,"")+"/100");-1!=b.indexOf("mixed")&&(g=g.replace(/(\d+)\s+(\d+\s*\/\s*\d+)/,"($1+$2)"));-1!=b.indexOf("scinot")&&
(g=g.replace("xx","*"));var h=eval(prepWithMath(mathjs(g)))}catch(l){e=_("syntax incomplete")+". "+e,h=NaN}isNaN(h)||"Infinity"==h?""!=str&&(str="`"+str+"` = "+_("undefined")+". "+wrapAMnotice(e)):str=-1!=b.indexOf("fraction")||-1!=b.indexOf("reducedfraction")||-1!=b.indexOf("mixednumber")||-1!=b.indexOf("scinot")||-1!=b.indexOf("noval")?"`"+str+"` "+wrapAMnotice(e):"`"+str+" =` "+(1E-15>Math.abs(h)?0:h)+". "+wrapAMnotice(e)}f[c]=str+" "}c=f.join(", ");-1!=b.indexOf("set")&&(c=document.getElementById(a).value.match(/^\s*{.*?}\s*$/)?
"{"+c+"}":c+wrapAMnotice(_("syntax error: this answer must be in set notation, a list wrapped in braces like {1,2,3}")));a=d.substr(1);setupLivePreview(a);LivePreviews[a].RenderNow(c)}
function ineqtointerval(a){a=a.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1");var d=a.split(/or/);for(i=0;i<d.length;i++)str=d[i],a="",(pat=str.match(/^([^<]+)\s*(<=?)\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*(<=?)([^<]+)$/))?(a="<="==pat[2]?a+"[":a+"(",a+=pat[1]+","+pat[5],a="<="==pat[4]?a+"]":a+")"):(pat=str.match(/^([^>]+)\s*(>=?)\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*(>=?)([^>]+)$/))?(a=">="==pat[4]?a+"[":a+"(",a+=pat[5]+","+pat[1],a=">="==pat[2]?a+"]":a+")"):(pat=str.match(/^([^><]+)\s*([><]=?)\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*$/))?
">"==pat[2]?a="(-oo,"+pat[1]+")":">="==pat[2]?a="(-oo,"+pat[1]+"]":"<"==pat[2]?a="("+pat[1]+",oo)":"<="==pat[2]&&(a="["+pat[1]+",oo)"):(pat=str.match(/^\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*([><]=?)\s*([^><]+)$/))?"<"==pat[2]?a="(-oo,"+pat[3]+")":"<="==pat[2]?a="(-oo,"+pat[3]+"]":">"==pat[2]?a="("+pat[3]+",oo)":">="==pat[2]&&(a="["+pat[3]+",oo)"):a=str.match(/all\s*real/i)?"(-oo,oo)":"",d[i]=a;return a=d.join("U")}
function intcalculate(a,d,b){a=document.getElementById(a).value;a=-1!=b.indexOf("mixed")?a.replace(/_/," ").replace(/^\s+/,"").replace(/\s+$/,""):a.replace(/\s+/g,"");a=normalizemathunicode(a);if(a.match(/DNE/i))a=a.toUpperCase();else if(""==a.replace(/\s+/g,""))a=_("no answer given");else{var c=[],f=[];if(-1!=b.indexOf("inequality")){var e=a=a.replace(/or/g," or ");a=ineqtointerval(a);var g=str.match(/\b([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+\b)/);var h=str.match(/([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)/);
g=null!=g?g[1]:null!=h?h[1]:""}else e=a;if(-1!=b.indexOf("list")){var l=0;h=[];for(var m=1;m<a.length-1;m++)","!=a.charAt(m)||")"!=a.charAt(m-1)&&"]"!=a.charAt(m-1)||"("!=a.charAt(m+1)&&"["!=a.charAt(m+1)||(h.push(a.substring(l,m)),l=m+1);h.push(a.substring(l))}else h=a.split(/\s*U\s*/i);m=!0;var n="";for(i=0;i<h.length;i++){str=h[i];sm=str.charAt(0);em=str.charAt(str.length-1);vals=str.substring(1,str.length-1);vals=vals.split(/,/);if(2!=vals.length||"("!=sm&&"["!=sm||")"!=em&&"]"!=em){-1!=b.indexOf("inequality")?
(e=e.replace("<=","le").replace(">=","ge").replace("<","lt").replace(">","gt"),a="`"+e+"`: "+wrapAMnotice(_("invalid inequality notation"))):a="`"+e.replace(/U/g,"uu")+"`: "+wrapAMnotice(_("invalid interval notation"));m=!1;break}for(j=0;2>j;j++)if(vals[j].match(/oo$/)||vals[j].match(/oo\W/))c[j]=vals[j];else{var p="";l=NaN;p+=singlevalsyntaxcheck(vals[j],b);-1!=b.indexOf("mixed")?vals[j]=vals[j].replace(/_/," "):vals[j]=vals[j].replace(/\s/g,"");p+=syntaxcheckexpr(vals[j],b);if(""==p)try{toeval=
vals[j],-1!=b.indexOf("mixed")&&(toeval=toeval.replace(/(\d+)\s+(\d+\s*\/\s*\d+)/,"($1+$2)")),l=eval(prepWithMath(mathjs(toeval)))}catch(q){p=_("syntax incomplete")+". "}isNaN(l)||"Infinity"==l?c[j]=_("undefined"):(vals[j]=vals[j],c[j]=(1E-15>Math.abs(l)?0:l).toString());""!=p&&(n+=p)}h[i]=sm+vals[0]+","+vals[1]+em;-1!=b.indexOf("inequality")?(c[0].match(/oo/)?c[1].match(/oo/)?f[i]="RR":f[i]=g+("]"==em?"le":"lt")+c[1]:c[1].match(/oo/)?f[i]=g+("["==sm?"ge":"gt")+c[0]:f[i]=c[0]+("["==sm?"le":"lt")+
g+("]"==em?"le":"lt")+c[1],f[i]=f[i].replace("undefined",'"undefined"')):f[i]=sm+c[0]+","+c[1]+em}m&&(-1!=b.indexOf("inequality")?e.match(/all\s*real/)?a=e:(e=e.replace(/or/g,' \\ "or" \\ '),e=e.replace(/<=/g,"le"),e=e.replace(/>=/g,"ge"),e=e.replace(/</g,"lt"),e=e.replace(/>/g,"gt"),a=-1!=b.indexOf("fraction")||-1!=b.indexOf("reducedfraction")||-1!=b.indexOf("mixednumber")||-1!=b.indexOf("scinot")||-1!=b.indexOf("noval")?"`"+e+"`. "+wrapAMnotice(n):"`"+e+"= "+f.join(' \\ "or" \\ ')+"`. "+wrapAMnotice(n)):
a=-1!=b.indexOf("fraction")||-1!=b.indexOf("reducedfraction")||-1!=b.indexOf("mixednumber")||-1!=b.indexOf("scinot")||-1!=b.indexOf("noval")?"`"+h.join("uu")+"`. "+wrapAMnotice(n):-1!=b.indexOf("list")?"`"+h.join(",")+"` = "+f.join(" , ")+". "+wrapAMnotice(n):"`"+h.join("uu")+"` = "+f.join(" U ")+". "+wrapAMnotice(n))}d=d.substr(1);setupLivePreview(d);LivePreviews[d].RenderNow(a)}
function ntuplecalc(a,d,b){var c=document.getElementById(a).value;c=normalizemathunicode(c);c=-1!=b.indexOf("mixed")?c.replace(/_/," ").replace(/^\s+/,"").replace(/\s+$/,""):c.replace(/\s+/g,"");if(c.match(/DNE/i))c.toUpperCase(),outstr=a="DNE";else{a="";var f=0;var e=0;var g="",h=!0;c.charAt(0).match(/[\(\[\<\{]/)||(h=!1);for(var l=0;l<c.length;l++)if(dec=!1,0==f&&(a+=c.charAt(l),e=l+1,","==c.charAt(l)&&(c.charAt(l+1).match(/[\(\[\<\{]/)&&c.charAt(l-1).match(/[\)\]\>\}]/)||(h=!1))),c.charAt(l).match(/[\(\[\<\{]/)?
f++:c.charAt(l).match(/[\)\]\>\}]/)&&(f--,dec=!0),0==f&&dec||1==f&&","==c.charAt(l)){sub=c.substring(e,l);e=NaN;g+=singlevalsyntaxcheck(sub,b);g+=syntaxcheckexpr(sub,b);try{-1!=b.indexOf("mixed")&&(sub=sub.replace(/(\d+)\s+(\d+\s*\/\s*\d+)/,"($1+$2)")),e=eval(prepWithMath(mathjs(sub)))}catch(m){g+=_("syntax incomplete")+". "}a=isNaN(e)||"Infinity"==e?a+_("undefined"):a+e;a+=c.charAt(l);e=l+1}0!=f&&(h=!1);0==h&&(g+=_("Invalid notation")+". ");outstr=-1!=b.indexOf("fraction")||-1!=b.indexOf("reducedfraction")||
-1!=b.indexOf("mixednumber")||-1!=b.indexOf("scinot")||-1!=b.indexOf("noval")||0==h?"`"+c+"`. "+wrapAMnotice(g):"`"+c+"` = "+a+". "+wrapAMnotice(g)}null!=d&&(d=d.substr(1),setupLivePreview(d),LivePreviews[d].RenderNow(outstr));return a}
function complexcalc(a,d,b){var c=document.getElementById(a).value;c=normalizemathunicode(c);c=-1!=b.indexOf("mixed")?c.replace(/_/," ").replace(/^\s+/,"").replace(/\s+$/,""):c.replace(/\s+/g,"");if(c.match(/DNE/i))c.toUpperCase(),b=a="DNE";else{var f=a="";for(var e=c.split(","),g=0;g<e.length;g++){var h=e[g];-1!=b.indexOf("mixed")&&(h=h.replace(/(\d+)\s+(\d+\s*\/\s*\d+)/,"($1+$2)"));h=mathjs(h,"i");if(-1==b.indexOf("sloppycomplex")){var l=parsecomplex(e[g]);f+=singlevalsyntaxcheck(l[0],b);f+=singlevalsyntaxcheck(l[1],
b)}f+=syntaxcheckexpr(e[g],b);try{var m=scopedeval("var i=0;"+prepWithMath(h));var n=scopedeval("var i=1;"+prepWithMath(h))}catch(p){f+=_("syntax incomplete")}if("synerr"==m||"synerr"==n)f+=_("syntax incomplete"),m=NaN;if(isNaN(m)||"Infinity"==m||isNaN(n)||"Infinity"==n){a+=_("undefined");break}else n-=m,0!=g&&(a+=","),a+=m+(0<=n?"+":"")+n+"i"}b=-1!=b.indexOf("fraction")||-1!=b.indexOf("reducedfraction")||-1!=b.indexOf("mixednumber")||-1!=b.indexOf("scinot")||-1!=b.indexOf("noval")?"`"+c+"`. "+wrapAMnotice(f):
"`"+c+"` = "+a+". "+wrapAMnotice(f)}null!=d&&(d=d.substr(1),setupLivePreview(d),LivePreviews[d].RenderNow(b));return a}
function parsecomplex(a){var d,b;a=a.replace(/\s/,"");a=a.replace(/\((\d+\*?i|i)\)\/(\d+)/g,"$1/$2");a=a.replace(/sin/,"s$n");a=a.replace(/pi/,"p$");var c=a.length;if(2<a.split("i").length)return _("error - more than 1 i in expression");var f=a.indexOf("i");if(-1==f){var e=a;var g="0"}else{g=0;for(b=f-1;0<b;b--)if(e=a.charAt(b),")"==e)g++;else if("("==e)g--;else if(("+"==e||"-"==e)&&0==g)break;0>b&&(b=0);g=0;for(d=f+1;d<c;d++)if(e=a.charAt(d),"("==e)g++;else if(")"==e)g--;else if(("+"==e||"-"==e)&&
0==g)break;if(0<f-b&&0<d-f&&(d==c||0==b)){if(d==c)e=a.substr(0,b),g=a.substr(b,f-b);else if(0==b)e=a.substr(d),g=a.substr(0,f);else return _("error - invalid form");g+="*"+a.substr(f+1+("*"==a.charAt(f+1)?1:0),d-f-1);g=g.replace("-*","-1*").replace("+*","+1*");g=g.replace(/(\+|-)1\*(.+)/g,"$1$2")}else if(1<f-b)g=a.substr(b,f-b),e=a.substr(0,b)+a.substr(f+1);else if(1<d-f)if(0<f){if("+"!=a.charAt(f-1)&&"-"!=a.charAt(f-1))return _("error - invalid form");g=a.charAt(f-1)+a.substr(f+1+("*"==a.charAt(f+
1)?1:0),d-f-1);e=a.substr(0,f-1)+a.substr(d)}else g=a.substr(f+1,d-f-1),e=a.substr(0,f)+a.substr(d);else g="+"==a.charAt(b)?"1":"-"==a.charAt(b)?"-1":0==f?"1":a.charAt(b),e=(0<f?a.substr(0,b):"")+a.substr(f+1);""==e&&(e="0");"/"==g.charAt(0)?g="1"+g:"+"!=g.charAt(0)&&"-"!=g.charAt(0)||"/"!=g.charAt(1)||(g=g.charAt(0)+"1"+g.substr(1));"*"==g.charAt(g.length-1)&&(g=g.substr(0,g.length-1));"+"==g.charAt(0)&&(g=g.substr(1));"+"==e.charAt(0)&&(e=e.substr(1))}e=e.replace("s$n","sin");e=e.replace("p$","pi");
g=g.replace("s$n","sin");g=g.replace("p$","pi");g=g.replace(/\*\//g,"/");return[e,g]}
function matrixcalc(a,d,b,c){function f(a){var b="";try{var c=eval(prepWithMath(mathjs(a)))}catch(r){b=_("syntax incomplete")}isNaN(c)||"Infinity"==c?""!=a&&(a=_("undefined")):a=(1E-15>Math.abs(c)?0:c)+b;return a}var e;if(null!=b&&null!=c){var g=0;var h=e="[";for(var l=0;l<b;l++){0<l&&(e+=",",h+=",");e+="(";h+="(";for(var m=0;m<c;m++)0<m&&(e+=",",h+=","),val=normalizemathunicode(document.getElementById(a+"-"+g).value),e+=val,h+=f(val),g++;e+=")";h+=")"}e+="]";h+="]"}else{e=normalizemathunicode(document.getElementById(a).value);
c=0;h=e.replace("[","(");h=h.replace("]",")");h=h.replace(/\s+/g,"");b=[];h=h.substring(1,h.length-1);for(a=g=0;a<h.length;a++)"("==h.charAt(a)?c++:")"==h.charAt(a)?c--:","==h.charAt(a)&&0==c&&(b[b.length]=h.substring(g+1,a-1),g=a+1);b[b.length]=h.substring(g+1,h.length-1);for(a=0;a<b.length;a++){calclist2=b[a].split(",");for(h=0;h<calclist2.length;h++)calclist2[h]=f(calclist2[h]);b[a]=calclist2.join(",")}h="[("+b.join("),(")+")]"}e="`"+e+"` = `"+h+"`";if(null!=d){d=document.getElementById(d);b=d.childNodes.length;
for(a=0;a<b;a++)d.removeChild(d.firstChild);d.appendChild(document.createTextNode(e));noMathRender||rendermathnode(d)}return h}function mathjsformat(a,d){var b=document.getElementById(a).value;document.getElementById(d).value=mathjs(b)}function stringqpreview(a,d){var b=document.getElementById(a).value,c=d.substr(1);setupLivePreview(c);LivePreviews[c].RenderNow("`"+b+"`")}
function AMnumfuncPrepVar(a,d){var b=vlist[a].split("|");b.push("DNE");d=d.replace(/,/g,"").replace(/^\s+/,"").replace(/\s+$/,"");d=normalizemathunicode(d);var c=[];var f=d.replace(/(arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root)/g,functoindex);for(var e=0;e<b.length;e++)if("varE"==b[e])d=d.replace("E","varE"),f=f.replace("E","varE");else{c[e]=!1;for(var g=0;g<b.length;g++)if(e!=
g&&b[g].toLowerCase()==b[e].toLowerCase()&&b[g]!=b[e]){c[e]=!0;break}c[e]||(d=d.replace(new RegExp(b[e],"gi"),b[e]),f=f.replace(new RegExp(b[e],"gi"),b[e]))}g=[];for(e=0;e<b.length;e++)if(1<b[e].length){var h=!1;-1!=arraysearch(b[e].toLowerCase(),greekletters)&&(h=!0);if(b[e].match(/^\w+_\w+$/)){h=c[e]?"g":"gi";var l=(new RegExp(/^(\w+)_(\w+)$/,h)).exec(b[e]),m=new RegExp(l[1]+"_\\("+l[2]+"\\)",h);f=f.replace(m,b[e]);d=d.replace(m,b[e]);1<l[1].length&&-1==arraysearch(l[1].toLowerCase(),greekletters)&&
(l[1]='"'+l[1]+'"');1<l[2].length&&-1==arraysearch(l[2].toLowerCase(),greekletters)&&(l[2]='"'+l[2]+'"');f=f.replace(new RegExp(l[0],h),l[1]+"_"+l[2]);d=d.replace(new RegExp(l[0],"g"),"repvars"+e);b[e]="repvars"+e}else h||"varE"==b[e]||g.push(b[e])}0<g.length&&(vltq=g.join("|"),f=f.replace(new RegExp("("+vltq+")","g"),'"$1"'));f=f.replace("varE","E");f=f.replace(/@(\d+)@/g,indextofunc);return[d,f,b.join("|")]}
function AMpreview(a,d){var b=a.slice(2);var c=AMnumfuncPrepVar(b,document.getElementById(a).value);var f=c[0],e=c[1],g=c[2],h=flist[b];ptlist=pts[b].split(",");var l="",m=0;c=NaN;var n=!1;1==iseqn[b]?(f.match(/=/)?1<f.match(/=/g).length&&(n=!0):n=!0,f=f.replace(/(.*)=(.*)/,"$1-($2)")):f.match(/=/)||(n=!0);""!=h&&(reg=new RegExp("("+h+")\\(","g"),f=f.replace(reg,"$1*sin($1+"));vars=g.split("|");for(h=prepWithMath(mathjs(f,g));m<ptlist.length&&(isNaN(c)||"Infinity"==c);){var p="";testvals=ptlist[m].split("~");
for(l=0;l<vars.length;l++)p+="var "+vars[l]+"="+testvals[l]+";";p+=h;l=_("syntax ok");try{c=scopedeval(p)}catch(q){l=_("syntax error")}"synerr"==c&&(l=_("syntax error"));m++}f=syntaxcheckexpr(f,"",g);if(isNaN(c)||"Infinity"==c)l=_("syntax error");""!=f&&(l=l==_("syntax ok")?l+(". "+_("warning")+": "+f):l+(". "+f));1==iseqn[b]&&n?l=_("syntax error: this is not an equation"):"undefined"!==typeof iseqn[b]||n||(l=_("syntax error: you gave an equation, not an expression"));if('"DNE"'==e||"oo"==e)l=_("syntax ok");
b=d.substr(1);setupLivePreview(b);LivePreviews[b].RenderNow("`"+e+"` "+wrapAMnotice(l))}function AMmathpreview(a,d){for(var b=document.getElementById(a).value,c=document.getElementById(d),f=c.childNodes.length,e=0;e<f;e++)c.removeChild(c.firstChild);c.appendChild(document.createTextNode("`"+b+"`"));noMathRender||rendermathnode(c)}
function singlevalsyntaxcheck(a,d){if(!a.match(/DNE/i)&&!a.match(/oo$/)&&!a.match(/oo\W/))if(-1!=d.indexOf("fracordec")){if(a=a.replace(/\s/g,""),!a.match(/^\-?\(?\d+\s*\/\s*\-?\d+\)?$/)&&!a.match(/^\-?\d+$/)&&!a.match(/^\-?(\d+|\d+\.\d*|\d*\.\d+)$/))return _(" invalid entry format")+". "}else if(-1!=d.indexOf("fraction")||-1!=d.indexOf("reducedfraction")){if(a=a.replace(/\s/g,""),!a.match(/^\(?\-?\(?\d+\)?\/\(?\d+\)?$/)&&!a.match(/^\(?\d+\)?\/\(?\-?\d+\)?$/)&&!a.match(/^\s*?\-?\d+\s*$/))return _("not a valid fraction")+
". "}else if(-1!=d.indexOf("mixednumber")){if(!a.match(/^\s*\-?\s*\d+\s*(_|\s)\s*\d+\s*\/\s*\d+\s*$/)&&!a.match(/^\s*?\-?\d+\s*$/)&&!a.match(/^\s*\-?\d+\s*\/\s*\-?\d+\s*$/))return _("not a valid mixed number")+". ";a.replace(/_/," ")}else if(-1!=d.indexOf("scinot")&&(a=a.replace(/\s/g,""),a=a.replace(/(x|X|\u00D7)/,"xx"),!a.match(/^\-?[1-9](\.\d*)?(\*|xx)10\^(\(?\-?\d+\)?)$/)))return _("not valid scientific notation")+". ";return""}
function syntaxcheckexpr(a,d,b){var c="";-1!=d.indexOf("notrig")&&a.match(/(sin|cos|tan|cot|sec|csc)/i)?c+=_("no trig functions allowed")+". ":-1!=d.indexOf("nodecimal")&&-1!=a.indexOf(".")&&(c+=_("no decimals allowed")+". ");for(var f=d=0,e=0,g=0;g<a.length;g++)"("==a.charAt(g)?d++:")"==a.charAt(g)?d--:"["==a.charAt(g)?f++:"]"==a.charAt(g)?f--:"|"==a.charAt(g)&&(e=1-e);if(0!=d||0!=f)c+=" ("+_("unmatched parens")+"). ";0!=e&&(c+=" ("+_("unmatched absolute value bars")+"). ");reg=b?new RegExp("(sqrt|ln|log|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs)s*("+
b+"|\\d+)","i"):/(sqrt|ln|log|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs)s*(\d+)/i;errstuff=a.match(reg);null!=errstuff&&(c+="["+_("use function notation")+" - "+_("use $1 instead of $2",errstuff[1]+"("+errstuff[2]+")",errstuff[0])+"]. ");b&&(reg=new RegExp("(repvars\\d+|arc|sqrt|root|ln|log|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs|pi|sign|DNE|e|oo|"+b+")","ig"),a.replace(reg,"").match(/[a-zA-Z]/)&&(c+=_(" Check your variables - you might be using an incorrect one")+
". "));if(2<(a.match(/\|/g)||[]).length)for(b=/\|.*?\|\s*(.|$)/g;match=b.exec(a);)if(""!=match[1]&&match[1].match(/[^+\-\*\/\^\)]/)){c+=_(" You may want to use abs(x) instead of |x| for absolute values to avoid ambiguity")+". ";break}a.match(/%/)&&!a.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(c+=_(" Do not use the percent symbol, %")+". ");return c}
var greekletters="alpha beta chi delta epsilon gamma phi psi sigma rho theta lambda mu nu omega tau".split(" "),calctoproc={},intcalctoproc={},calcformat={},functoproc={},matcalctoproc={},ntupletoproc={},complextoproc={},callbackstack={},matsize={},vlist={},flist={},pts={},iseqn={};
function doonsubmit(a,d,b){for(c in callbackstack)callbackstack[c](c);if(null!=a){if("submitted"==a.className)return alert(_("You have already submitted this page.  Please be patient while your submission is processed.")),a.className="submitted2",!1;if("submitted2"==a.className)return!1;a.className="submitted";if(!b&&(d=d?confirmSubmit2(a):confirmSubmit(a),!d))return a.className="",!1}imathasDraw.encodea11ydraw();for(c in intcalctoproc){var c=parseInt(c);if(null!=document.getElementById("tc"+c)){fullstr=
document.getElementById("tc"+c).value;fullstr=-1!=calcformat[c].indexOf("mixed")?fullstr.replace(/_/," ").replace(/^\s+/,"").replace(/\s+$/,""):fullstr.replace(/\s+/g,"");fullstr=normalizemathunicode(fullstr);if(fullstr.match(/DNE/i))fullstr=fullstr.toUpperCase();else{-1!=calcformat[c].indexOf("inequality")&&(fullstr=ineqtointerval(fullstr));if(-1!=calcformat[c].indexOf("list")){d=0;a=[];for(b=1;b<fullstr.length-1;b++)","!=fullstr.charAt(b)||")"!=fullstr.charAt(b-1)&&"]"!=fullstr.charAt(b-1)||"("!=
fullstr.charAt(b+1)&&"["!=fullstr.charAt(b+1)||(a.push(fullstr.substring(d,b)),d=b+1);a.push(fullstr.substring(d))}else a=fullstr.split(/\s*U\s*/i);for(k=0;k<a.length;k++)if(str=a[k],0<str.length&&str.match(/,/)){sm=str.charAt(0);em=str.charAt(str.length-1);vals=str.substring(1,str.length-1);vals=vals.split(/,/);for(j=0;2>j;j++)if(!vals[j].match(/oo$/)&&!vals[j].match(/oo\W/)){d="";try{-1!=calcformat[c].indexOf("mixed")&&(vals[j]=vals[j].replace(/(\d+)\s+(\d+\s*\/\s*\d+)/,"($1+$2)"));var f=eval(prepWithMath(mathjs(vals[j])))}catch(e){d=
"syntax incomplete"}isNaN(f)||"Infinity"==f||(vals[j]=(1E-15>Math.abs(f)?0:f)+d)}a[k]=sm+vals[0]+","+vals[1]+em}fullstr=-1!=calcformat[c].indexOf("list")?a.join(","):a.join("U")}document.getElementById("qn"+c).value=fullstr}}for(c in calctoproc)if(c=parseInt(c),null!=document.getElementById("tc"+c)){str=document.getElementById("tc"+c).value;str=normalizemathunicode(str);str=str.replace(/=/,"");if(-1!=calcformat[c].indexOf("list"))a=str.split(/,/);else if(-1!=calcformat[c].indexOf("set"))if(str.match(/^\s*{.*?}\s*$/))a=
str.replace(/^\s*{(.*?)}\s*$/,"$1").split(/,/);else continue;else a=[],a[0]=str;for(d=0;d<a.length;d++){str=a[d];str=str.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1");str=str.replace(",","*NaN*");if(-1!=calcformat[c].indexOf("scinot")||-1!=calcformat[c].indexOf("allowxtimes"))str=str.replace(/(x|X|\u00D7)/,"*");str.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(str=str.replace(/%/,"")+"/100");str=str.replace(/(\d+)\s*_\s*(\d+\s*\/\s*\d+)/,"($1+$2)");-1!=calcformat[c].indexOf("mixed")&&(str=str.replace(/(\d+)\s+(\d+\s*\/\s*\d+)/,
"($1+$2)"));if(str.match(/^\s*$/))f="";else if(str.match(/oo$/)||str.match(/oo\W/))f=str;else if(str.match(/DNE/i))f=str.toUpperCase();else try{f=eval(prepWithMath(mathjs(str)))}catch(e){f=""}a[d]=f}document.getElementById("qn"+c).value=a.join(",")}for(c in matcalctoproc){c=parseInt(c);if(null!=matsize[c]){if(null==document.getElementById("qn"+c+"-0"))continue;msize=matsize[c].split(",");str=matrixcalc("qn"+c,null,msize[0],msize[1])}else{if(null==document.getElementById("tc"+c))continue;str=matrixcalc("tc"+
c,null)}document.getElementById("qn"+c).value=str}for(c in ntupletoproc)c=parseInt(c),null!=document.getElementById("tc"+c)&&(str=ntuplecalc("tc"+c,null,calcformat[c]),document.getElementById("qn"+c).value=str);for(c in complextoproc)c=parseInt(c),null!=document.getElementById("tc"+c)&&(str=complexcalc("tc"+c,null,calcformat[c]),document.getElementById("qn"+c).value=str);for(c in functoproc)if(c=parseInt(c),null!=document.getElementById("tc"+c)){str=document.getElementById("tc"+c).value;str=str.replace(/,/g,
"");str=normalizemathunicode(str);f=AMnumfuncPrepVar(c,str);str=f[0];varlist=f[2];if(1==iseqn[c])str=str.replace(/(.*)=(.*)/,"$1-($2)");else if(str.match("="))continue;fl=flist[c];""!=fl&&(reg=new RegExp("("+fl+")\\(","g"),str=str.replace(reg,"$1*sin($1+"));vars=varlist.split("|");f=document.getElementById("qn"+c);f.value=mathjs(str,varlist);ptlist=pts[c].split(",");vals=[];for(a=0;a<ptlist.length;a++){inputs=ptlist[a].split("~");totest="";for(d=0;d<inputs.length;d++)totest+="var "+vars[d]+"="+inputs[d]+
";";totest=""==f.value?totest+(Math.random()+";"):totest+(prepWithMath(f.value)+";");try{vals[a]=scopedeval(totest)}catch(e){vals[a]=NaN}"synerr"==vals[a]&&(vals[a]=NaN)}document.getElementById("qn"+c+"-vals").value=vals.join(",")}return!0}function scopedeval(a){var d;try{return d=eval(a)}catch(b){return"synerr"}}function arraysearch(a,d){for(var b=0;b<d.length;b++)if(d[b]==a)return b;return-1}
function toggleinlinebtn(a,d){var b=document.getElementById(d),c=document.getElementById(a);"none"==c.style.display?(c.style.display="",c.setAttribute("aria-hidden",!1),b.setAttribute("aria-expanded",!0)):(c.style.display="none",c.setAttribute("aria-hidden",!0),b.setAttribute("aria-expanded",!1));c=b.innerHTML;b.innerHTML=c.match(/\[\+\]/)?c.replace(/\[\+\]/,"[-]"):c.replace(/\[\-\]/,"[+]")}
function assessbackgsubmit(a,d){var b;"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();doonsubmit();var c={},f=!!window.FormData;f&&(b=new FormData);var e=[];var g=document.getElementsByTagName("input");for(var h=0;h<g.length;h++)e.push(g[h]);g=document.getElementsByTagName("select");for(h=0;h<g.length;h++)e.push(g[h]);g=document.getElementsByTagName("textarea");for(h=0;h<g.length;h++)e.push(g[h]);g=null!=a?new RegExp("^(qn|tc|qs)("+a+"\\b|"+(a+1)+"\\d{3})"):/^(qn|tc|qs)/;for(h=0;h<e.length;h++)e[h].name.match(g)&&
("radio"!=e[h].type&&"checkbox"!=e[h].type||e[h].checked)&&(f?"file"==e[h].type?b.append(e[h].name,e[h].files[0]):b.append(e[h].name,e[h].value):"file"==e[h].type?alert("File upload submissions are not supported by this browser"):c[e[h].name]=e[h].value);null!==a?f?(b.append("toscore",a),b.append("verattempts",document.getElementById("verattempts"+a).value)):(c.toscore=a,c.verattempts=document.getElementById("verattempts"+a).value):f?b.append("verattempts",document.getElementById("verattempts").value):
c.verattempts=document.getElementById("verattempts").value;f?(b.append("asidverify",document.getElementById("asidverify").value),b.append("disptime",document.getElementById("disptime").value),b.append("isreview",document.getElementById("isreview").value)):(c.asidverify=document.getElementById("asidverify").value,c.disptime=document.getElementById("disptime").value,c.isreview=document.getElementById("isreview").value);b={type:"POST",url:assesspostbackurl,data:f?b:c,dataType:"text",qn:a,noticetgt:d};
f&&(b.contentType=!1,b.processData=!1);$.ajax(b).done(function(a){null!=this.noticetgt&&(document.getElementById(this.noticetgt).innerHTML="");if(null!==this.qn){for(var b=this.qn,c=[];-1<a.indexOf("<script")||-1<a.indexOf("\x3c/script");){var d=a.indexOf("<script"),f=a.indexOf(">",d),e=a.indexOf("\x3c/script",d),g=a.indexOf(">",e);c.push(a.substring(f+1,e));a=a.substring(0,d)+a.substring(g+1)}document.getElementById("embedqwrapper"+b).innerHTML=a;usingASCIIMath&&rendermathnode(document.getElementById("embedqwrapper"+
b));usingASCIISvg&&setTimeout("drawPics()",100);usingTinymceEditor&&initeditor("textareas","mceEditor");for(a=initstack.length=0;a<c.length;a++)try{if(k=c[a].match(/canvases\[(\d+)\]/))"undefined"!=typeof G_vmlCanvasManager&&(c[a]=c[a]+'G_vmlCanvasManager.initElement(document.getElementById("canvas'+k[1]+'"));'),c[a]=c[a]+"imathasDraw.initCanvases("+k[1]+");";eval(c[a])}catch(t){}for(a=0;a<initstack.length;a++)initstack[a]();c=(b+1).toString().length;for(a in LivePreviews)(a==b||999<a&&a.toString().substr(0,
c)==b+1)&&LivePreviews[a].Init();$(window).trigger("ImathasEmbedReload");c=0;"undefined"!=typeof window.pageYOffset?c=window.pageYOffset:(c=document.body,a=document.documentElement,a=a.clientHeight?a:c,c=a.scrollTop);var h=findPos(document.getElementById("embedqwrapper"+b))[1];c>h&&setTimeout(function(){window.scroll(0,h)},150)}}).fail(function(a){null!=this.noticetgt&&(document.getElementById(this.noticetgt).innerHTML=_("Submission Error"))})}
function AutoSuggest(a,d){var b=this;this.elem=a;this.suggestions=d;this.eligible=[];this.inputText=null;this.highlighted=-1;this.div=document.getElementById("autosuggest");null==this.div&&(this.div=document.createElement("div"),this.div.id="autosuggest",document.getElementsByTagName("body")[0].appendChild(this.div),this.div.appendChild(document.createElement("ul")));a.setAttribute("autocomplete","off");if(!a.id){var c="autosuggest"+AutoSuggestIdCounter;AutoSuggestIdCounter++;a.id=c}a.onkeydown=function(a){a=
b.getKeyCode(a);switch(a){case 9:b.useSuggestion("tab");break;case 13:return b.useSuggestion("enter"),!1;case 27:b.hideDiv();break;case 38:0<b.highlighted&&b.highlighted--;b.changeHighlight(a);break;case 40:b.highlighted<b.eligible.length-1&&b.highlighted++,b.changeHighlight(a)}};a.onkeyup=function(a){switch(b.getKeyCode(a)){case 9:case 27:case 38:case 40:break;default:1<this.value.length?(b.inputText=this.value,b.getEligible(),b.highlighted=0<b.eligible.length?0:-1,b.createDiv(),b.positionDiv(),
b.showDiv()):(b.hideDiv(),0==this.value.length&&(b.inputText=""))}};a.onblur=function(a){setTimeout(b.hideDiv,100)};this.useSuggestion=function(a){-1<this.highlighted&&(this.elem.value=this.eligible[this.highlighted]);this.hideDiv()};this.showDiv=function(){this.div.style.display="block"};this.hideDiv=function(){b.div.style.display="none";b.highlighted=-1};this.changeHighlight=function(){var a=this.div.getElementsByTagName("LI");for(i in a)a[i].className=this.highlighted==i?"selected":""};this.positionDiv=
function(){var a=this.elem,b=findPos(a);b[1]+=a.offsetHeight;this.div.style.left=b[0]+"px";this.div.style.top=b[1]+"px"};this.createDiv=function(){var a=document.createElement("ul");for(i in this.eligible){var c=this.eligible[i],d=document.createElement("li"),h=document.createElement("a");h.href="#";h.onclick=function(){return!1};h.innerHTML=c;d.appendChild(h);b.highlighted==i&&(d.className="selected");a.appendChild(d)}this.div.replaceChild(a,this.div.childNodes[0]);a.onmouseover=function(a){for(a=
b.getEventSource(a);a.parentNode&&"LI"!=a.tagName.toUpperCase();)a=a.parentNode;var c=b.div.getElementsByTagName("LI");for(i in c)if(c[i]==a){b.highlighted=i;break}b.changeHighlight()};a.onclick=function(a){b.useSuggestion("click");b.hideDiv();b.cancelEvent(a);return!1};this.div.className="suggestion_list";this.div.style.position="absolute"};this.getEligible=function(){this.eligible=[];if(-1==this.inputText.indexOf(" ")){var a=new RegExp("\\b"+this.inputText.toLowerCase());for(i in this.suggestions){var b=
this.suggestions[i];b.toLowerCase().match(a)&&(this.eligible[this.eligible.length]=b)}}};this.getKeyCode=function(a){if(a)return a.keyCode;if(window.event)return window.event.keyCode};this.getEventSource=function(a){if(a)return a.target;if(window.event)return window.event.srcElement};this.cancelEvent=function(a){a&&(a.preventDefault(),a.stopPropagation());window.event&&(window.event.returnValue=!1)}}var AutoSuggestIdCounter=0;function isBlank(a){return!a||0===a.length||/^\s*$/.test(a)}
function editdebit(a){var d=$("#qn"+(1*a.id.substr(2)-1));!isBlank(a.value)&&d.hasClass("iscredit")&&(d.is("select")?d.css("margin-right",20):d.width(d.width()+20),d.css("padding-left",0),d.removeClass("iscredit"))}function editcredit(a){var d=$("#qn"+(1*a.id.substr(2)-2));isBlank(a.value)||d.hasClass("iscredit")||(d.is("select")?d.css("margin-right",0):d.width(d.width()-20),d.css("padding-left",20),d.addClass("iscredit"))}
function initcreditboxes(){$(".creditbox").each(function(a,d){if(!isBlank(d.value)&&20!=$(d).css("padding-left")){var b=$("#qn"+(1*d.id.substr(2)-2));b.is("select")?b.css("margin-right",0):b.width(b.width()-20);b.css("padding-left",20);b.addClass("iscredit")}})}initstack.push(initcreditboxes);$(window).on("ImathasEmbedReload",initcreditboxes);
function initqsclickchange(){$("input[id^=qs][value=spec]").each(function(a,d){$(d).siblings("input[type=text]").off("keyup.qsclickchange").on("keyup.qsclickchange",function(a){8!=a.keyCode&&46!=a.keyCode&&$(d).prop("checked",!0)})})}$(window).on("ImathasEmbedReload",initqsclickchange);initstack.push(initqsclickchange);
function initShowAnswer(){$("input.sabtn + span.hidden").attr("aria-hidden",!0).attr("aria-expanded",!1);$("input.sabtn").each(function(){var a=$(this).siblings("span:first-of-type").attr("id");$(this).attr("aria-expanded",!1).attr("aria-controls",a).off("click.sashow").on("click.sashow",function(){$(this).attr("aria-expanded",!0).siblings("span:first-of-type").attr("aria-expanded",!0).attr("aria-hidden",!1).removeClass("hidden")})})}$(window).on("ImathasEmbedReload",initShowAnswer);initstack.push(initShowAnswer);
function assessmentTimer(a,d){var b=Date.now(),c,f,e,g,h;var l=setInterval(function(){c=a-Math.floor((Date.now()-b)/1E3);if(0>=c){c=0;clearInterval(l);if(d){document.getElementById("timelimitholder").className="noticetext";document.getElementById("timelimitholder").innerHTML=_("Time limit expired - submitting now");document.getElementById("timelimitholder").style.fontSize="300%";if(null==document.getElementById("qform")){setTimeout("window.location.href='"+imasroot+"/assessment/showtest.php?action=skip&superdone=true'",
2E3);return}var m=document.getElementById("qform"),n=m.getAttribute("action");m.setAttribute("action",n+"&superdone=true");doonsubmit(m,!0,!0)&&setTimeout('document.getElementById("qform").submit()',2E3);return 0}alert(_("Time Limit has elapsed"))}g=Math.floor(c%60);e=Math.floor(c/60%60);f=Math.floor(c/3600);0==f&&5>e&&(document.getElementById("timeremaining").className="noticetext");0==f&&0==e&&5>=g&&(document.getElementById("timeremaining").style.fontSize="150%");h=(0<f?f+":":"")+(0<f&&10>e?"0":
"")+e+":"+(10>g?"0":"")+g;document.getElementById("timeremaining").innerHTML=h},1E3);$(document).ready(function(){var a=$("#timerwrap"),b=a.position();$(window).scroll(function(){$(window).scrollTop()>=b.top?a.addClass("sticky"):a.removeClass("sticky")})})}
function toggletimer(){"[x]"==$("#timerhide").text()?($("#timercontent").hide(),$("#timerhide").text("["+_("Show Timer")+"]"),$("#timerhide").attr("title","["+_("Show Timer")+"]")):($("#timercontent").show(),$("#timerhide").text("[x]"),$("#timerhide").attr("title",_("Hide Timer")))}
function toggleintroshow(a){var d=document.getElementById("introtoggle"+a);a=document.getElementById("intropiece"+a);d.innerHTML.match("Hide")?(d.innerHTML=d.innerHTML.replace("Hide","Show"),$(d).attr("aria-expanded",!1),a.style.display="none",$(a).attr("aria-hidden",!0).attr("aria-expanded",!1)):(d.innerHTML=d.innerHTML.replace("Show","Hide"),$(d).attr("aria-expanded",!0),a.style.display="block",$(a).attr("aria-hidden",!1).attr("aria-expanded",!0))}
function togglemainintroshow(a){$("#intro").hasClass("hidden")?($(a).html(_("Hide Intro/Instructions")).attr("aria-expanded",!0),$("#intro").removeClass("hidden").addClass("intro").attr("aria-hidden",!1).attr("aria-expanded",!0)):($("#intro").addClass("hidden").attr("aria-hidden",!0).attr("aria-expanded",!1),$(a).html(_("Show Intro/Instructions")).attr("aria-expanded",!1))}
function prepWithMath(a){a=a.replace(/\b(abs|acos|asin|atan|ceil|floor|cos|sin|tan|sqrt|exp|max|min|pow)\(/g,"Math.$1(");return a=a.replace(/\((E|PI)\)/g,"(Math.$1)")};

function checkComplete(b){if("undefined"!=typeof tinyMCE)try{tinyMCE.triggerSave()}catch(f){}if(!b.elements)return!0;for(var c=0;c<b.elements.length;c++){var a=b.elements[c];if("undefined"!=typeof a.type&&"undefined"!=typeof a.name&&""!=a.name&&!$(a).is(":not(:visible)"))if("text"==a.type||"textarea"==a.type||"password"==a.type||"file"==a.type){if(""==a.value&&0==$("#qs"+a.id.substr(2)+"-d:checked,#qs"+a.id.substr(2)+"-i:checked").length)return!1}else if(-1!=a.type.indexOf("select")){if(-1==a.selectedIndex)return!1}else if("radio"==
a.type){var d=b[a.name],e=!1;if(d.length)for(a=0;a<d.length&&!(e=d[a].checked);a++);else e=a.checked;if(!e)return!1}}return!0}function confirmSubmit(b){return checkComplete(b)?!0:confirm("Not all question parts have been answered.  Are you sure you want to submit this question?")}
function confirmSubmit2(b){return checkComplete(b)?!0:confirm("Not all questions have been answered completely.  If you are saving your answers for later, this is fine.  If you are submitting for grading, are you sure you want to submit now?")};

var canvases=[],drawla=[],imathasDraw=function(v){function rb(a,k){var e=a[0];ra.push(e);var c=a[1].substr(9).split(","),h=a[2],f=a[3],b=a[4],m=a[5];b==m&&(b=-1,m=1);var q=a[6],u=a[7],t=a[8],G=document.getElementById("a11ydraw"+e);Va[e]=document.getElementById("qn"+e);g[e]={el:G,xmin:h,xmax:f,ymin:b,ymax:m,imgborder:q,imgwidth:u,imgheight:t};g[e].pixperx=(u-2*q)/(f-h);g[e].pixpery=b==m?1:(t-2*q)/(m-b);"inequality"==c[0]?(h=c.shift(),0==c.length?c=["line"]:"both"==c[0]&&(c=["line","parab"])):"twopoint"==
c[0]?(h=c.shift(),0==c.length&&(c=["line","parab","abs","circle","dot"])):"numberline"==c[0]?(h="basic",c.shift()):h="basic";g[e].afgroup=h;f={inequality:{line:[{mode:10,descr:_("Linear inequality with solid line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")},{mode:10.2,descr:_("Linear inequality with dashed line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")}],parab:[{mode:10.3,descr:_("Parabolic inequality with solid line"),
inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")},{mode:10.4,descr:_("Parabolic inequality with dashed line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")}]},twopoint:{line:[{mode:5,descr:_("Line"),inN:2,input:_("Enter two points on the line")}],lineseg:[{mode:5.3,descr:_("Line segment"),inN:2,input:_("Enter the starting and ending point of the line segment")}],ray:[{mode:5.2,descr:_("Ray"),inN:2,input:_("Enter the starting point of the ray and another point on the ray")}],
parab:[{mode:6,descr:_("Parabola"),inN:2,input:_("Enter the vertex, then another point on the parabola")}],horizparab:[{mode:6.1,descr:_("Parabola opening right or left"),inN:2,input:_("Enter the vertex, then another point on the parabola")}],sqrt:[{mode:6.5,descr:_("Square root"),inN:2,input:_("Enter the starting point of the square root, then another point on the graph")}],abs:[{mode:8,descr:_("Absolute value"),inN:2,input:_("Enter the corner point of the absolute value, then another point on the graph")}],
rational:[{mode:8.2,descr:_("Rational"),inN:2,input:_("Enter the point where the vertical and horizontal asymptote cross, then a point on the graph")}],exp:[{mode:8.3,descr:_("Exponential"),inN:2,input:_("Enter two points on the graph")}],circle:[{mode:7,descr:_("Circle"),inN:2,input:_("Enter the center point of the circle, then a point on the graph")}],ellipse:[{mode:7.2,descr:_("Ellipse"),inN:2,input:_("Enter the center point of the ellipse, then a point offset from the center by the horizontal radius and vertical radius")}],
hyperbola:[{mode:7.4,descr:_("Vertical hyperbola"),inN:2,input:_("Enter the center point of the hyperbola, then a point (x,y) where x is the x-coordinate of the co-vertex and y is the y-coordinate of the vertex")},{mode:7.5,descr:_("Horizontal hyperbola"),inN:2,input:_("Enter the center point of the hyperbola, then a point (x,y) where x is the x-coordinate of the vertex and y is the y-coordinate of the co-vertex")}],dot:[{mode:1,descr:_("Solid dot"),inN:1,input:_("Enter the coordinates of the dot")}],
opendot:[{mode:2,descr:_("Open dot"),inN:1,input:_("Enter the coordinates of the dot")}],trig:[{mode:9,descr:_("Cosine"),inN:2,input:_("Enter a point at the start of a phase, then a point half a phase further")},{mode:9.2,descr:_("Sine"),inN:2,input:_("Enter a point at the start of a phase, then a point a quarter phase further")}],vector:[{mode:5.4,descr:_("Vector"),inN:2,input:_("Enter the starting and ending point of the vector")}]},basic:{line:[{mode:0,descr:_("Lines"),inN:"list",input:_("Enter list of points to connect with lines")}],
lineseg:[{mode:.5,descr:_("Line segment"),inN:2,input:_("Enter the starting and ending point of the line segment")}],freehand:[{mode:.7,descr:_("Freehand"),inN:"list",input:_("Enter list of points to connect with lines")}],dot:[{mode:1,descr:_("Solid dot"),inN:1,input:_("Enter the coordinates of the dot")}],opendot:[{mode:2,descr:_("Open dot"),inN:1,input:_("Enter the coordinates of the dot")}],polygon:[{mode:1,descr:_("Polygon"),inN:"list",input:_("Enter list of points to place dots connected with lines"),
dotline:1}],closedpolygon:[{mode:1,descr:_("Polygon"),inN:"list",input:_("Enter list of points to place dots connected with lines"),dotline:2}]}};b=[];m=[];q=[];for(t=0;t<c.length;t++)if(f[h].hasOwnProperty(c[t])){if(0==t)var v=f[h][c[t]][0].mode;for(G=0;G<f[h][c[t]].length;G++)q[f[h][c[t]][G].mode]=f[h][c[t]][G],b.push(f[h][c[t]][G].mode),u='<option value="'+f[h][c[t]][G].mode+'"',u+=' data-af="'+c[t]+'">'+f[h][c[t]][G].descr+"</option>",m.push(u)}g[e].defmode=v;g[e].inputmodes=b;g[e].selects=m;
g[e].moderef=q;if(null==k&&n.hasOwnProperty(e)){for(t=0;t<n[e].length;t++)O(e,0,T(n[e][t],e));for(t=0;t<F[e].length;t++)O(e,1,T(F[e][t],e));for(t=0;t<C[e].length;t++)O(e,2,T(C[e][t],e));for(t=0;t<d[e].length;t++)O(e,y[e][t],T(d[e][t][0],e)+","+T(d[e][t][1],e));for(t=0;t<l[e].length;t++)O(e,L[e][t],T(l[e][t][0],e)+","+T(l[e][t][1],e)+","+T(l[e][t][2],e))}else if(null!=k)for(t=0;t<k.length;t++)O(e,k[t][0],k[t][1].replace(/\[/g,"(").replace(/\]/g,")"))}function O(a,d,e){var c=g[a];d=d||c.defmode;var h=
e||"";html='<select aria-label="'+_("Drawing element type")+'" onchange="imathasDraw.changea11ydraw(this,\''+a+"')\">";for(j in c.selects)html+=c.selects[j];html+="</select><br/>";html+='<span class="a11ydrawinstr"></span><br/>';html+='<input type="text" aria-label="'+_("Point list")+'" value="'+h+'"/>';html+='<button type="button" class="imgbutton" onclick="imathasDraw.removea11ydraw(this)">';html+=_("Remove")+"</button>";a=v("<li>",{"class":"a11ydrawrow"}).html(html);v(c.el).append(a);a.find("select").val(d);
a.find(".a11ydrawinstr").text(c.moderef[d].input);e||a.find("select").focus()}function T(a,d){var e=g[d];var c=(a[0]-e.imgborder)/e.pixperx+e.xmin;e=(e.imgheight-a[1]-e.imgborder)/e.pixpery+e.ymin;c=Math.round(100*c)/100;e=Math.round(100*e)/100;return"("+c+","+e+")"}function sb(h,k,e,c,m,f,b,q,u,v,t,G,w,J,A){k=document.getElementById(k);k.style.userSelect="none";k.style.webkitUserSelect="none";k.style.MozUserSelect="none";var E=M(k);g[h]={el:k,left:E.x,top:E.y,width:k.offsetWidth,height:k.offsetHeight,
xmin:m,xmax:f,ymin:b,ymax:q,imgborder:u,imgwidth:v,imgheight:t,mode:G,dotline:w};"string"==typeof A&&-1!=A.indexOf(":")?(A=A.split(":"),g[h].snaptogridx=1*A[0],g[h].snaptogridy=1*A[1]):(g[h].snaptogridx=A,g[h].snaptogridy=A);g[h].pixperx=(v-2*u)/(f-m);g[h].pixpery=b==q?1:(t-2*u)/(q-b);Va[h]=document.getElementById(c);null==n[h]&&(n[h]=[]);null==F[h]&&(F[h]=[]);null==C[h]&&(C[h]=[]);null==d[h]&&(d[h]=[]);null==y[h]&&(y[h]=[]);null==l[h]&&(l[h]=[]);null==L[h]&&(L[h]=[]);Ga[h]=5<=G?1:0;fa[h]=J;Wa[h]=
new Image;Wa[h].onload=function(){var b=a;a=h;B();a=b};Wa[h].src=e}function B(h,k){var e,c,E;try{var f=g[a].el.getContext("2d")}catch(wb){jb||(jb=!0,alert("Your browser does not support drawing answer entry.  Please try again using Internet Explorer 6+ (Windows), FireFox 1.5+ (Win/Mac), Safari 1.3+ (Mac), Opera 9+ (Win/Mac), or Camino (Mac)"))}f.fillStyle="rgb(0,0,255)";f.lineWidth=2;f.strokeStyle="rgb(0,0,255)";f.clearRect(0,0,g[a].imgwidth,g[a].imgheight);f.drawImage(Wa[a],0,0);f.beginPath();for(var b=
0;b<l[a].length;b++){var v=b%3;f.strokeStyle=kb[v];f.fillStyle=kb[v];var w=e=E=null,B=c=null;3==l[a][b].length?(e=l[a][b][1][0],c=l[a][b][1][1],w=l[a][b][2][0],B=l[a][b][2][1]):2==l[a][b].length?(e=l[a][b][1][0],c=l[a][b][1][1],w=h,B=k):A==b&&null!=h&&1==l[a][b].length&&(e=h,c=k);if(null!=w){f.save();f.fillStyle=ub[v];f.beginPath();if(10.2>=L[a][b]){e!=l[a][b][0][0]&&(E=(c-l[a][b][0][1])/(e-l[a][b][0][0]));if(1>Math.abs(e-l[a][b][0][0])||100<Math.abs(E))f.moveTo(l[a][b][0][0],0),f.lineTo(l[a][b][0][0],
g[a].imgheight),w>e?(f.lineTo(g[a].imgwidth,g[a].imgheight),f.lineTo(g[a].imgwidth,0)):(f.lineTo(0,g[a].imgheight),f.lineTo(0,0));else{var t=E*(w-e)+c;var G=l[a][b][0][1]-E*l[a][b][0][0];var ea=l[a][b][0][1]+E*(g[a].imgwidth-l[a][b][0][0]);f.moveTo(0,G);f.lineTo(g[a].imgwidth,ea);B>t?(f.lineTo(g[a].imgwidth,g[a].imgheight),f.lineTo(0,g[a].imgheight)):(f.lineTo(g[a].imgwidth,0),f.lineTo(0,0))}f.closePath()}else{var J=f,I=l[a][b][0][0],M=l[a][b][0][1],T=e,Q=c,O=w,ba=B,ca=g[a].imgwidth,da=g[a].imgheight;
J.beginPath();if(Q==M)J.moveTo(0,Q),J.lineTo(ca,Q),ba<M?(J.lineTo(ca,0),J.lineTo(0,0)):(J.lineTo(ca,da),J.lineTo(0,da));else{var U=(Q-M)/((T-I)*(T-I)),sa=-2*U*I,oa=0;Q>M&&(oa=da);var Ha=U*I*I+M-oa,va=Math.sqrt(sa*sa-4*U*Ha);Ha+=oa;var ha=(-sa-va)/(2*U),za=U*ha*ha+sa*ha+Ha,Aa=(-sa+va)/(2*U),ma=za;if(Aa<ha){var Ea=ha;ha=Aa;Aa=Ea}var na=2*U*(ha-I),wa=za-na*ha,xa=-na,ra=(wa-(ma-xa*Aa))/(xa-na),Fa=na*ra+wa;if(0>U&&ba<U*O*O+sa*O+Ha||0<U&&ba>U*O*O+sa*O+Ha)J.moveTo(ha,za),J.quadraticCurveTo(ra,Fa,Aa,ma);
else{var ya=da;2>Math.abs(za-da)&&(ya=0);J.moveTo(0,za);J.lineTo(ha,za);J.quadraticCurveTo(ra,Fa,Aa,ma);J.lineTo(ca,ma);J.lineTo(ca,ya);J.lineTo(0,ya)}}J.closePath()}f.fill();f.restore()}f.beginPath();if(null!=e)if(10.2>=L[a][b])e!=l[a][b][0][0]&&(E=(c-l[a][b][0][1])/(e-l[a][b][0][0])),1>Math.abs(e-l[a][b][0][0])||100<Math.abs(E)?10.2==L[a][b]?null!=m&&10<=m.mode&&11>m.mode&&m.num==b&&0==m.subnum?(f.dashedLine(l[a][b][1][0],l[a][b][1][1],l[a][b][1][0],g[a].imgheight),f.dashedLine(l[a][b][1][0],l[a][b][1][1],
l[a][b][1][0],0)):(f.dashedLine(l[a][b][0][0],l[a][b][0][1],l[a][b][0][0],g[a].imgheight),f.dashedLine(l[a][b][0][0],l[a][b][0][1],l[a][b][0][0],0)):(f.moveTo(l[a][b][0][0],0),f.lineTo(l[a][b][0][0],g[a].imgheight),f.stroke()):(G=l[a][b][0][1]-E*l[a][b][0][0],ea=l[a][b][0][1]+E*(g[a].imgwidth-l[a][b][0][0]),10.2==L[a][b]?null!=m&&10<=m.mode&&11>m.mode&&m.num==b&&0==m.subnum?(f.dashedLine(l[a][b][1][0],l[a][b][1][1],g[a].imgwidth,ea),f.dashedLine(l[a][b][1][0],l[a][b][1][1],0,G)):(f.dashedLine(l[a][b][0][0],
l[a][b][0][1],g[a].imgwidth,ea),f.dashedLine(l[a][b][0][0],l[a][b][0][1],0,G)):(f.moveTo(0,G),f.lineTo(g[a].imgwidth,ea),f.stroke()));else if(10.3==L[a][b]){if(e!=l[a][b][0][0])if(c==l[a][b][0][1])f.moveTo(0,c),f.lineTo(g[a].imgwidth,c);else{var D=(c-l[a][b][0][1])/((e-l[a][b][0][0])*(e-l[a][b][0][0]));if(c>l[a][b][0][1]){var K=Math.sqrt((g[a].imgheight-l[a][b][0][1])/D)+l[a][b][0][0];var V=-1*Math.sqrt((g[a].imgheight-l[a][b][0][1])/D)+l[a][b][0][0];var Ia=l[a][b][0][1]-(g[a].imgheight-l[a][b][0][1]);
var W=g[a].imgheight}else K=Math.sqrt((0-l[a][b][0][1])/D)+l[a][b][0][0],V=-1*Math.sqrt((0-l[a][b][0][1])/D)+l[a][b][0][0],Ia=2*l[a][b][0][1],W=0;var pa=K+2/3*(l[a][b][0][0]-K);var qa=W+2/3*(Ia-W);var Ja=pa+(V-K)/3;var Ka=qa;f.moveTo(K,W);f.bezierCurveTo(pa,qa,Ja,Ka,V,W)}f.stroke()}else if(e!=l[a][b][0][0]){var ta=f,ja=l[a][b][0][0],Ba=l[a][b][0][1],Ga=e,Ca=c,Pa=g[a].imgwidth,ab=g[a].imgheight;if(Ca==Ba)ta.moveTo(0,Ca),ta.dashedLine(0,Ca,Pa,Ca);else{var X=(Ca-Ba)/((Ga-ja)*(Ga-ja)),Da=-2*X*ja,cb=0;
Ca>Ba&&(cb=ab);var Xa=X*ja*ja+Ba-cb,Qa=Math.sqrt(Da*Da-4*X*Xa);Xa+=cb;var Ya=(-Da-Qa)/(2*X),Za=(-Da+Qa)/(2*X);if(Za<Ya){var bb=Ya;Ya=Za;Za=bb}for(var H=ja,ua=Ba,La=0;H>Ya-5&&-5<H;)0==La%2?ta.moveTo(H,ua):ta.lineTo(H,ua),H-=Math.min(Math.sqrt(64/(1+Math.pow(2*X*(H-ja),2))),Math.sqrt(8/Math.abs(X))),ua=X*H*H+Da*H+Xa,La++;H=ja;ua=Ba;for(La=0;H<Za+5&&H<Pa+5;)0==La%2?ta.moveTo(H,ua):ta.lineTo(H,ua),H+=Math.min(Math.sqrt(64/(1+Math.pow(2*X*(H-ja),2))),Math.sqrt(8/Math.abs(X))),ua=X*H*H+Da*H+Xa,La++}ta.stroke()}f.beginPath();
for(var x=0;x<l[a][b].length;x++)2==x?(f.arc(l[a][b][x][0],l[a][b][x][1],4,0,2*Math.PI,!0),f.fill()):f.fillRect(l[a][b][x][0]-3,l[a][b][x][1]-3,6,6);1==l[a][b].length&&null!=e&&f.fillRect(e-3,c-3,6,6);f.beginPath()}f.fillStyle="rgb(0,0,255)";f.lineWidth=1==fa[a]?4:2;f.strokeStyle="rgb(0,0,255)";for(b=0;b<d[a].length;b++){if(5<=y[a][b]&&6>y[a][b]){if(c=e=E=null,2==d[a][b].length?(e=d[a][b][1][0],c=d[a][b][1][1]):u==b&&null!=h&&1==d[a][b].length&&(e=h,c=k),null!=e)if(5.3==y[a][b]||5.4==y[a][b]){if(f.moveTo(d[a][b][0][0],
d[a][b][0][1]),f.lineTo(e,c),5.4==y[a][b]){var R=[e-d[a][b][0][0],c-d[a][b][0][1]];var db=Math.sqrt(R[0]*R[0]+R[1]*R[1]);if(1E-4<db){R=[R[0]/db,R[1]/db];var $a=[-R[1],R[0]];f.moveTo(e-15*R[0]-4*$a[0],c-15*R[1]-5*$a[1]);f.lineTo(e,c);f.moveTo(e-15*R[0]+4*$a[0],c-15*R[1]+5*$a[1]);f.lineTo(e,c)}}}else e!=d[a][b][0][0]&&(E=(c-d[a][b][0][1])/(e-d[a][b][0][0])),1>Math.abs(e-d[a][b][0][0])||100<Math.abs(E)?5.2==y[a][b]?(f.moveTo(d[a][b][0][0],d[a][b][0][1]),c>d[a][b][0][1]?f.lineTo(d[a][b][0][0],g[a].imgheight):
f.lineTo(d[a][b][0][0],0)):(f.moveTo(d[a][b][0][0],0),f.lineTo(d[a][b][0][0],g[a].imgheight)):(G=d[a][b][0][1]-E*d[a][b][0][0],ea=d[a][b][0][1]+E*(g[a].imgwidth-d[a][b][0][0]),5.2==y[a][b]?(f.moveTo(d[a][b][0][0],d[a][b][0][1]),e>d[a][b][0][0]?f.lineTo(g[a].imgwidth,ea):f.lineTo(0,G)):(f.moveTo(0,G),f.lineTo(g[a].imgwidth,ea)))}else if(6==y[a][b]||6.1==y[a][b]){if(e=c=null,2==d[a][b].length?(e=d[a][b][1][0],c=d[a][b][1][1]):u==b&&null!=h&&1==d[a][b].length&&(e=h,c=k),null!=e)if(6==y[a][b])c==d[a][b][0][1]?
(f.moveTo(0,c),f.lineTo(g[a].imgwidth,c)):e==d[a][b][0][0]?(f.moveTo(e,d[a][b][0][1]),c>d[a][b][0][1]?f.lineTo(e,g[a].imgheight):f.lineTo(e,0)):(D=(c-d[a][b][0][1])/((e-d[a][b][0][0])*(e-d[a][b][0][0])),c>d[a][b][0][1]?(K=Math.sqrt((g[a].imgheight-d[a][b][0][1])/D)+d[a][b][0][0],V=-1*Math.sqrt((g[a].imgheight-d[a][b][0][1])/D)+d[a][b][0][0],Ia=d[a][b][0][1]-(g[a].imgheight-d[a][b][0][1]),W=g[a].imgheight):(K=Math.sqrt((0-d[a][b][0][1])/D)+d[a][b][0][0],V=-1*Math.sqrt((0-d[a][b][0][1])/D)+d[a][b][0][0],
Ia=2*d[a][b][0][1],W=0),pa=K+2/3*(d[a][b][0][0]-K),qa=W+2/3*(Ia-W),Ja=pa+(V-K)/3,Ka=qa,f.moveTo(K,W),f.bezierCurveTo(pa,qa,Ja,Ka,V,W));else if(6.1==y[a][b])if(e==d[a][b][0][0])f.moveTo(e,0),f.lineTo(e,g[a].imgheight);else if(c==d[a][b][0][1])f.moveTo(d[a][b][0][0],c),e>d[a][b][0][0]?f.lineTo(g[a].imgwidth,c):f.lineTo(0,c);else{D=(e-d[a][b][0][0])/((c-d[a][b][0][1])*(c-d[a][b][0][1]));if(e>d[a][b][0][0]){K=Math.sqrt((g[a].imgwidth-d[a][b][0][0])/D)+d[a][b][0][1];V=-1*Math.sqrt((g[a].imgwidth-d[a][b][0][0])/
D)+d[a][b][0][1];var Ra=d[a][b][0][0]-(g[a].imgwidth-d[a][b][0][0]);var Ma=g[a].imgwidth}else K=Math.sqrt((0-d[a][b][0][0])/D)+d[a][b][0][1],V=-1*Math.sqrt((0-d[a][b][0][0])/D)+d[a][b][0][1],Ra=2*d[a][b][0][0],Ma=0;qa=K+2/3*(d[a][b][0][1]-K);pa=Ma+2/3*(Ra-Ma);Ka=qa+(V-K)/3;Ja=pa;f.moveTo(Ma,K);f.bezierCurveTo(pa,qa,Ja,Ka,Ma,V)}}else if(6.5==y[a][b]){if(e=c=null,2==d[a][b].length?(e=d[a][b][1][0],c=d[a][b][1][1]):u==b&&null!=h&&1==d[a][b].length&&(e=h,c=k),null!=e&&e!=d[a][b][0][0])if(c==d[a][b][0][1])f.moveTo(d[a][b][0][0],
c),e>d[a][b][0][0]?f.lineTo(g[a].imgwidth,c):f.lineTo(0,c);else{var eb=e<d[a][b][0][0]?-1:1;D=(c-d[a][b][0][1])/Math.sqrt(eb*(e-d[a][b][0][0]));f.moveTo(d[a][b][0][0],d[a][b][0][1]);p=d[a][b][0][0];var r=d[a][b][0][1];do p+=3*eb,f.lineTo(p,D*Math.sqrt(eb*(p-d[a][b][0][0]))+d[a][b][0][1]);while(0<p&&p<g[a].imgwidth&&0<r&&r<g[a].imgheight)}}else if(7<=y[a][b]&&8>y[a][b]){if(e=c=null,2==d[a][b].length?(e=d[a][b][1][0],c=d[a][b][1][1]):u==b&&null!=h&&1==d[a][b].length&&(e=h,c=k),null!=e&&(e!=d[a][b][0][0]||
c!=d[a][b][0][1]))if(7==y[a][b])f.arc(d[a][b][0][0],d[a][b][0][1],Math.sqrt((e-d[a][b][0][0])*(e-d[a][b][0][0])+(c-d[a][b][0][1])*(c-d[a][b][0][1])),0,2*Math.PI,!0);else if(7.2==y[a][b]){var Sa=Math.abs(e-d[a][b][0][0]),Ta=Math.abs(c-d[a][b][0][1]);if(u==b||null!=m&&m.num==b)f.strokeStyle="rgb(0,255,255)",f.lineWidth=1,f.dashedLine(e,c,e-2*(e-d[a][b][0][0]),c,5),f.dashedLine(e,c,e,c-2*(c-d[a][b][0][1]),5),f.dashedLine(e,c-2*(c-d[a][b][0][1]),e-2*(e-d[a][b][0][0]),c-2*(c-d[a][b][0][1]),5),f.dashedLine(e-
2*(e-d[a][b][0][0]),c,e-2*(e-d[a][b][0][0]),c-2*(c-d[a][b][0][1]),5),f.lineWidth=2;f.strokeStyle="rgb(0,0,255)";f.save();f.beginPath();f.translate(d[a][b][0][0]-Sa,d[a][b][0][1]-Ta);f.scale(Sa,Ta);f.arc(1,1,1,0,2*Math.PI,!1);f.restore()}else if(7.4==y[a][b]){var Y=Math.abs(e-d[a][b][0][0]);var Z=Math.abs(c-d[a][b][0][1]);var ka=Math.abs(Z/Y);f.strokeStyle="rgb(0,255,0)";f.dashedLine(d[a][b][0][0],d[a][b][0][1],g[a].imgwidth,d[a][b][0][1]+ka*(g[a].imgwidth-d[a][b][0][0]));f.dashedLine(d[a][b][0][0],
d[a][b][0][1],g[a].imgwidth,d[a][b][0][1]-ka*(g[a].imgwidth-d[a][b][0][0]));f.dashedLine(d[a][b][0][0],d[a][b][0][1],0,d[a][b][0][1]-ka*d[a][b][0][0]);f.dashedLine(d[a][b][0][0],d[a][b][0][1],0,d[a][b][0][1]+ka*d[a][b][0][0]);if(u==b||null!=m&&m.num==b)f.strokeStyle="rgb(0,255,255)",f.lineWidth=1,f.dashedLine(e,c,e-2*(e-d[a][b][0][0]),c,5),f.dashedLine(e,c,e,c-2*(c-d[a][b][0][1]),5),f.dashedLine(e,c-2*(c-d[a][b][0][1]),e-2*(e-d[a][b][0][0]),c-2*(c-d[a][b][0][1]),5),f.dashedLine(e-2*(e-d[a][b][0][0]),
c,e-2*(e-d[a][b][0][0]),c-2*(c-d[a][b][0][1]),5),f.lineWidth=2;f.beginPath();f.strokeStyle="rgb(0,0,255)";for(var p=0;p<g[a].imgwidth+4;p+=3)r=d[a][b][0][1]+Math.sqrt((Math.pow(p-d[a][b][0][0],2)/(Y*Y)+1)*Z*Z),-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),0==p?f.moveTo(p,r):f.lineTo(p,r);f.stroke();f.beginPath();for(p=0;p<g[a].imgwidth+4;p+=3)r=d[a][b][0][1]-Math.sqrt((Math.pow(p-d[a][b][0][0],2)/(Y*Y)+1)*Z*Z),-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),0==p?f.moveTo(p,
r):f.lineTo(p,r)}else if(7.5==y[a][b]){Z=Math.abs(e-d[a][b][0][0]);Y=Math.abs(c-d[a][b][0][1]);ka=Math.abs(Y/Z);f.strokeStyle="rgb(0,255,0)";f.dashedLine(d[a][b][0][0],d[a][b][0][1],g[a].imgwidth,d[a][b][0][1]+ka*(g[a].imgwidth-d[a][b][0][0]));f.dashedLine(d[a][b][0][0],d[a][b][0][1],g[a].imgwidth,d[a][b][0][1]-ka*(g[a].imgwidth-d[a][b][0][0]));f.dashedLine(d[a][b][0][0],d[a][b][0][1],0,d[a][b][0][1]-ka*d[a][b][0][0]);f.dashedLine(d[a][b][0][0],d[a][b][0][1],0,d[a][b][0][1]+ka*d[a][b][0][0]);if(u==
b||null!=m&&m.num==b)f.strokeStyle="rgb(0,255,255)",f.lineWidth=1,f.dashedLine(e,c,e-2*(e-d[a][b][0][0]),c,5),f.dashedLine(e,c,e,c-2*(c-d[a][b][0][1]),5),f.dashedLine(e,c-2*(c-d[a][b][0][1]),e-2*(e-d[a][b][0][0]),c-2*(c-d[a][b][0][1]),5),f.dashedLine(e-2*(e-d[a][b][0][0]),c,e-2*(e-d[a][b][0][0]),c-2*(c-d[a][b][0][1]),5),f.lineWidth=2;f.beginPath();f.strokeStyle="rgb(0,0,255)";for(r=0;r<g[a].imgwidth+4;r+=3)p=d[a][b][0][0]+Math.sqrt((Math.pow(r-d[a][b][0][1],2)/(Y*Y)+1)*Z*Z),-100>p&&(p=-100),p>g[a].imgwidth+
100&&(p=g[a].imgwidth+100),0==r?f.moveTo(p,r):f.lineTo(p,r);f.stroke();f.beginPath();for(r=0;r<g[a].imgwidth+4;r+=3)p=d[a][b][0][0]-Math.sqrt((Math.pow(r-d[a][b][0][1],2)/(Y*Y)+1)*Z*Z),-100>p&&(p=-100),p>g[a].imgwidth+100&&(p=g[a].imgwidth+100),0==r?f.moveTo(p,r):f.lineTo(p,r)}}else if(8==y[a][b])c=e=E=null,2==d[a][b].length?(e=d[a][b][1][0],c=d[a][b][1][1]):u==b&&null!=h&&1==d[a][b].length&&(e=h,c=k),null!=e&&(e!=d[a][b][0][0]&&(E=(c-d[a][b][0][1])/(e-d[a][b][0][0]),e<d[a][b][0][0]&&(E*=-1)),1>Math.abs(e-
d[a][b][0][0])||100<Math.abs(E)?(f.moveTo(d[a][b][0][0],d[a][b][0][1]),c>d[a][b][0][1]?f.lineTo(d[a][b][0][0],g[a].imgheight):f.lineTo(d[a][b][0][0],0)):(G=d[a][b][0][1]+E*d[a][b][0][0],ea=d[a][b][0][1]+E*(g[a].imgwidth-d[a][b][0][0]),f.moveTo(0,G),f.lineTo(d[a][b][0][0],d[a][b][0][1]),f.lineTo(g[a].imgwidth,ea)));else if(8.3==y[a][b]){if(e=c=null,2==d[a][b].length?(e=d[a][b][1][0],c=d[a][b][1][1]):u==b&&null!=h&&1==d[a][b].length&&(e=h,c=k),null!=e&&e!=d[a][b][0][0])if(c==d[a][b][0][1])f.moveTo(0,
c),f.lineTo(g[a].imgwidth,c);else{var fb=g[a].ymax*g[a].pixpery+g[a].imgborder,Ua=fb-d[a][b][0][1],gb=fb-c;if(0<Ua*gb&&e!=d[a][b][0][0]){var Na=safepow(gb/Ua,1/(e-d[a][b][0][0]));D=gb/safepow(Na,e);f.moveTo(d[a][b][0][0],d[a][b][0][1]);for(p=0;p<g[a].imgwidth+4;p+=3)r=fb-D*safepow(Na,p),-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),0==p?f.moveTo(p,r):f.lineTo(p,r)}}}else if(8.4==y[a][b]){if(e=c=null,2==d[a][b].length?(e=d[a][b][1][0],c=d[a][b][1][1]):u==b&&null!=h&&1==d[a][b].length&&
(e=h,c=k),null!=e&&e!=d[a][b][0][0]&&c!=d[a][b][0][1]){var hb=-g[a].xmin*g[a].pixperx+g[a].imgborder,lb=hb-d[a][b][0][0],ib=hb-e;if(0<lb*ib&&c!=d[a][b][0][1])for(Na=safepow(ib/lb,1/(c-d[a][b][0][1])),D=ib/safepow(Na,c),f.moveTo(d[a][b][0][0],d[a][b][0][1]),r=0;r<g[a].imgheight+4;r+=3)p=hb-D*safepow(Na,r),-100>p&&(p=-100),p>g[a].imgwidth+100&&(p=g[a].imgwidth+100),0==r?f.moveTo(p,r):f.lineTo(p,r)}}else if(8.2==y[a][b]){if(e=c=null,2==d[a][b].length?(e=d[a][b][1][0],c=d[a][b][1][1]):u==b&&null!=h&&
1==d[a][b].length&&(e=h,c=k),f.strokeStyle="rgb(0,255,0)",f.dashedLine(5,d[a][b][0][1],g[a].imgwidth,d[a][b][0][1]),f.dashedLine(d[a][b][0][0],5,d[a][b][0][0],g[a].imgheight),f.beginPath(),f.strokeStyle="rgb(0,0,255)",null!=e&&e!=d[a][b][0][0]&&c!=d[a][b][0][1]){D=(c-d[a][b][0][1])*(e-d[a][b][0][0]);for(p=d[a][b][0][0]-1;-4<p;p-=3)r=D/(p-d[a][b][0][0])+d[a][b][0][1],-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),p==d[a][b][0][0]-1?f.moveTo(p,r):f.lineTo(p,r);for(p=d[a][b][0][0]+1;p<
g[a].imgwidth+4;p+=3)r=D/(p-d[a][b][0][0])+d[a][b][0][1],-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),p==d[a][b][0][0]+1?f.moveTo(p,r):f.lineTo(p,r);f.stroke()}}else if(9==y[a][b]||9.1==y[a][b])if(e=c=null,2==d[a][b].length?(e=d[a][b][1][0],c=d[a][b][1][1]):u==b&&null!=h&&1==d[a][b].length&&(e=h,c=k),null!=e&&e!=d[a][b][0][0])if(c==d[a][b][0][1])f.moveTo(0,c),f.lineTo(g[a].imgwidth,c);else{if(9==y[a][b]){var mb=-1*Math.abs(c-d[a][b][0][1])/2;var nb=(c+d[a][b][0][1])/2;D=Math.PI/Math.abs(e-
d[a][b][0][0]);var ob=c<d[a][b][0][1]?e:d[a][b][0][0]}else 9.1==y[a][b]&&(mb=-1*Math.abs(c-d[a][b][0][1]),nb=d[a][b][0][1],D=.5*Math.PI/Math.abs(e-d[a][b][0][0]),ob=c<d[a][b][0][1]?e:e+2*Math.abs(e-d[a][b][0][0]));for(p=0;p<g[a].imgwidth+4;p+=3)r=mb*Math.cos(D*(p-ob))+nb,0==p?f.moveTo(p,r):f.lineTo(p,r)}f.stroke();f.beginPath()}f.fillStyle="rgba(0,0,255,.5)";for(b=0;b<n[a].length;b++){f.beginPath();for(x=0;x<n[a][b].length;x++)if(0==x){f.moveTo(n[a][b][x][0],n[a][b][x][1]);var aa=n[a][b][x][0];var la=
n[a][b][x][1]}else{f.lineTo(n[a][b][x][0],n[a][b][x][1]);var S=n[a][b][x][0];var ia=n[a][b][x][1]}b==q&&null!=h&&(f.lineTo(h,k),S=h,ia=k);var N=.02*g[a].imgwidth;1==fa[a]&&S>.98*g[a].imgwidth?(f.moveTo(S,ia),f.lineTo(S-N,ia+N),f.moveTo(S,ia),f.lineTo(S-N,ia-N)):1==fa[a]&&aa>.98*g[a].imgwidth&&(f.moveTo(aa,la),f.lineTo(aa-N,la+N),f.moveTo(aa,la),f.lineTo(aa-N,la-N));1==fa[a]&&S<.02*g[a].imgwidth?(f.moveTo(S,ia),f.lineTo(S+N,ia+N),f.moveTo(S,ia),f.lineTo(S+N,ia-N)):1==fa[a]&&aa<.02*g[a].imgwidth&&(f.moveTo(aa,
la),f.lineTo(aa+N,la+N),f.moveTo(aa,la),f.lineTo(aa+N,la-N));f.stroke();if(1<g[a].dotline&&!(1>n[a][b].length-1)&&25>Math.pow(S-aa,2)+Math.pow(ia-la,2)){f.moveTo(n[a][b][0][0],n[a][b][0][1]);for(x=1;x<n[a][b].length;x++)f.lineTo(n[a][b][x][0],n[a][b][x][1]);f.closePath();f.fill()}}f.fillStyle="rgb(0,0,255)";f.beginPath();for(b=0;b<F[a].length;b++)f.moveTo(F[a][b][0]+5,F[a][b][1]),f.arc(F[a][b][0],F[a][b][1],5,0,2*Math.PI,!0);f.fill();if(0<g[a].dotline){f.beginPath();for(b=0;b<n[a].length;b++)for(x=
0;x<n[a][b].length;x++)if(0==x||25<Math.pow(n[a][b][x][0]-n[a][b][x-1][0],2)+Math.pow(n[a][b][x][1]-n[a][b][x-1][1],2))f.moveTo(n[a][b][x][0]+5,n[a][b][x][1]),f.arc(n[a][b][x][0],n[a][b][x][1],5,0,2*Math.PI,!0);f.fill()}f.fillStyle="rgb(255,255,255)";f.beginPath();for(b=0;b<C[a].length;b++)f.moveTo(C[a][b][0]+5,C[a][b][1]),f.arc(C[a][b][0],C[a][b][1],4,0,2*Math.PI,!0);3>g[a].mode?f.fill():f.stroke();f.lineWidth=2;f.beginPath();for(b=0;b<C[a].length;b++)f.moveTo(C[a][b][0]+5,C[a][b][1]),f.arc(C[a][b][0],
C[a][b][1],4,0,2*Math.PI,!0);f.stroke();for(b=0;b<d[a].length;b++)if(y[a][b]==g[a].mode){f.fillStyle="rgb(255,0,0)";for(x=0;x<d[a][b].length;x++)f.fillRect(d[a][b][x][0]-3,d[a][b][x][1]-3,6,6);1==d[a][b].length&&null!=h&&u==b&&f.fillRect(h-3,k-3,6,6);f.fillStyle="rgb(0,0,255)"}for(var P="",z=0;z<n[a].length;z++){0!=z&&(P+=";");for(var Oa=0;Oa<n[a][z].length;Oa++)0!=Oa&&(P+=","),P+="("+n[a][z][Oa][0]+","+n[a][z][Oa][1]+")"}P+=";;";for(z=0;z<F[a].length;z++)0!=z&&(P+=","),P+="("+F[a][z][0]+","+F[a][z][1]+
")";P+=";;";for(z=0;z<C[a].length;z++)0!=z&&(P+=","),P+="("+C[a][z][0]+","+C[a][z][1]+")";P+=";;";var pb=[];for(z=0;z<d[a].length;z++)1<d[a][z].length&&pb.push("("+y[a][z]+","+d[a][z][0][0]+","+d[a][z][0][1]+","+d[a][z][1][0]+","+d[a][z][1][1]+")");P+=pb.join(",");P+=";;";var qb=[];for(z=0;z<l[a].length;z++)2<l[a][z].length&&qb.push("("+L[a][z]+","+l[a][z][0][0]+","+l[a][z][0][1]+","+l[a][z][1][0]+","+l[a][z][1][1]+","+l[a][z][2][0]+","+l[a][z][2][1]+")");P+=qb.join(",");Va[a].value=P}function ba(h){vb++;
va();if(I&&1<h.originalEvent.touches.length)return ca=!0,v(document).on("touchend.imathasdraw",ma),!0;I?(window.clearTimeout(Pa),v(".drawcanvas").on("touchstart.imathasdraw",function(a){I=!0;ba(a)}),v(".drawcanvas").on("touchmove.imathasdraw",da),v(document).on("touchend.imathasdraw",ma),v(document).on("touchcancel.imathasdraw",ma)):(v(document).on("mousemove.imathasdraw",da),v(document).on("mouseup.imathasdraw",ma));var k=Ea(h);if(null==a||null==q&&null==u&&null==A)for(i in g){var e=M(g[i].el);if(e.x<
k.x&&e.x+g[i].width>k.x&&e.y<k.y&&e.y+g[i].height>k.y){a=i;break}}null!=a&&(h.preventDefault(),Q=!0,e=M(g[a].el),h={x:k.x-e.x,y:k.y-e.y},-1<h.x&&h.x<g[a].width&&-1<h.y&&h.y<g[a].height?(0<g[a].snaptogridx&&(h=na(h,a)),1==fa[a]&&(h.y=g[a].imgheight/2),e=oa(a,h),null!=e&&(null!=q&&1>e[0]&&q!=e[1]?e=null:null!=u&5<=e[0]&&10>e[0]&&u!=e[1]?e=null:null!=A&&10<=e[0]&&11>e[0]&&A!=e[1]&&(e=null)),null==e?(g[a].el.style.cursor="url("+imasroot+"/img/pendown.cur), default",1==g[a].mode?(F[a].push([h.x,h.y]),
m={mode:1,num:F[a].length-1}):2==g[a].mode?(C[a].push([h.x,h.y]),m={mode:2,num:C[a].length-1}):0==g[a].mode||.7==g[a].mode?null==q?(n[a].push([[h.x,h.y]]),q=n[a].length-1):n[a][q].push([h.x,h.y]):.5==g[a].mode?null==q?(n[a].push([[h.x,h.y]]),q=n[a].length-1):(n[a][q].push([h.x,h.y]),m=q=null):5<=g[a].mode&&10>g[a].mode?null==u?(d[a].push([[h.x,h.y]]),u=d[a].length-1,y[a][u]=g[a].mode,Q=!1):(d[a][u].push([h.x,h.y]),2==d[a][u].length&&(m={mode:g[a].mode,num:u,subnum:1},u=null)):10<=g[a].mode&&11>g[a].mode&&
(null==A?(l[a].push([[h.x,h.y]]),A=l[a].length-1,L[a][A]=g[a].mode,Q=!1):(l[a][A].push([h.x,h.y]),3==l[a][A].length&&(m={mode:g[a].mode,num:A,subnum:1},A=null)))):(0==e[0]||.5==e[0]?null==q?(g[a].el.style.cursor="move",m={mode:g[a].mode,num:e[1],subnum:e[2]},wa=n[a][e[1]][e[2]],e[2]==n[a][e[1]].length-1&&0==g[a].mode?q=e[1]:0==e[2]&&0==g[a].mode&&(q=e[1],n[a][q].reverse(),m.subnum=n[a][q].length-1)):e[1]==q&&e[2]==n[a][e[1]].length-1?(2>n[a][q].length&&n[a].splice(q,1),q=null):1<g[a].dotline&&e[1]==
q&&0==e[2]?(n[a][q].push(n[a][q][0]),q=null):(g[a].el.style.cursor="url("+imasroot+"/img/pendown.cur), default",n[a][q].push([h.x,h.y])):1==e[0]?(g[a].el.style.cursor="move",m={mode:1,num:e[1]}):2==e[0]?(g[a].el.style.cursor="move",m={mode:2,num:e[1]}):5<=e[0]&&10>e[0]?(g[a].el.style.cursor="move",m={mode:e[0],num:e[1],subnum:e[2]},wa=d[a][e[1]][e[2]]):10<=e[0]&&11>e[0]&&(g[a].el.style.cursor="move",m={mode:e[0],num:e[1],subnum:e[2]},wa=l[a][e[1]][e[2]]),Fa=!0),B()):(null!=q&&(2>n[a][q].length&&n[a].splice(q,
1),g[a].el.style.cursor="url("+imasroot+"/img/pen.cur), default"),null!=u&&(2>d[a][u].length&&d[a].splice(u,1),g[a].el.style.cursor="url("+imasroot+"/img/pen.cur), default"),null!=A&&(3>l[a][A].length&&l[a].splice(A,1),g[a].el.style.cursor="url("+imasroot+"/img/pen.cur), default"),m=A=u=q=null,B(),a=null))}function oa(a,k){if(I){var e=Math.max(15*window.innerWidth/screen.width,15);e*=e}else e=25;if(0==Ga[a])if(0==g[a].mode||.5==g[a].mode)for(var c=0;c<n[a].length;c++)for(var h=n[a][c].length-1;0<=
h;h--){var f=Math.pow(n[a][c][h][0]-k.x,2)+Math.pow(n[a][c][h][1]-k.y,2);if(f<e)return[g[a].mode,c,h]}else if(1==g[a].mode)for(c=0;c<F[a].length;c++){if(Math.pow(F[a][c][0]-k.x,2)+Math.pow(F[a][c][1]-k.y,2)<e)return[1,c]}else if(2==g[a].mode)for(c=0;c<C[a].length;c++){if(Math.pow(C[a][c][0]-k.x,2)+Math.pow(C[a][c][1]-k.y,2)<e)return[2,c]}else if(5<=g[a].mode&&10>g[a].mode)for(c=0;c<d[a].length;c++){if(y[a][c]==g[a].mode)for(h=d[a][c].length-1;0<=h;h--)if(f=Math.pow(d[a][c][h][0]-k.x,2)+Math.pow(d[a][c][h][1]-
k.y,2),f<e)return[y[a][c],c,h]}else{if(10<=g[a].mode&&11>g[a].mode)for(c=0;c<l[a].length;c++)for(h=l[a][c].length-1;0<=h;h--)if(f=Math.pow(l[a][c][h][0]-k.x,2)+Math.pow(l[a][c][h][1]-k.y,2),f<e)return[L[a][c],c,h]}else if(1==g[a].mode)for(c=0;c<F[a].length;c++){if(Math.pow(F[a][c][0]-k.x,2)+Math.pow(F[a][c][1]-k.y,2)<e)return[1,c]}else if(2==g[a].mode)for(c=0;c<C[a].length;c++){if(Math.pow(C[a][c][0]-k.x,2)+Math.pow(C[a][c][1]-k.y,2)<e)return[2,c]}else if(5<=g[a].mode&&10>g[a].mode)for(c=0;c<d[a].length;c++)for(h=
d[a][c].length-1;0<=h;h--){if(y[a][c]==g[a].mode&&(f=Math.pow(d[a][c][h][0]-k.x,2)+Math.pow(d[a][c][h][1]-k.y,2),f<e))return[y[a][c],c,h]}else if(10<=g[a].mode&&11>g[a].mode)for(c=0;c<l[a].length;c++)for(h=l[a][c].length-1;0<=h;h--)if(f=Math.pow(l[a][c][h][0]-k.x,2)+Math.pow(l[a][c][h][1]-k.y,2),f<e)return[L[a][c],c,h];return null}function ma(h){var k=Ea(h);Q=!1;if(null!=a){var e=M(g[a].el);var c={x:k.x-e.x,y:k.y-e.y};0<g[a].snaptogridx&&(c=na(c,a));e=-1<c.x&&c.x<g[a].width&&-1<c.y&&c.y<g[a].height;
1==Fa&&(5<=g[a].mode&&10>g[a].mode?(d[a].push([[c.x,c.y]]),u=d[a].length-1,y[a][u]=g[a].mode):10<=g[a].mode&&11>g[a].mode&&(l[a].push([[c.x,c.y]]),A=l[a].length-1,L[a][A]=g[a].mode));null!=xa&&k.x==xa.x&&k.y==xa.y&&null!=q&&null==m&&(2>n[a][q].length&&n[a].splice(q,1),m=q=null,B());null!=q&&null==m&&(.5==g[a].mode&&1<n[a][q].length?(dragobj=q=null,B()):.7==g[a].mode&&(dragobj=q=null,B()));null!=u&&1==d[a][u].length&&(ca||!e?(d[a].splice(u,1),u=null,B()):null==oa(a,c)&&(d[a][u].push([c.x,c.y]),u=null,
B()));null!=A&&1==l[a][A].length&&(ca||!e?(l[a].splice(A,1),A=null,B()):null==oa(a,c)&&(l[a][A].push([c.x,c.y]),B()));g[a].el.style.cursor=null==q&&null==u?"move":"url("+imasroot+"/img/pen.cur), default";"undefined"!=typeof h&&h.preventDefault()}xa=k;null!=a&&null!=m&&(e=M(g[a].el),-1<c.x&&c.x<g[a].width&&-1<c.y&&c.y<g[a].height?(0==m.mode&&1<g[a].dotline&&(0==m.subnum||m.subnum==n[a][m.num].length-1)&&25>Math.pow(n[a][m.num][0][0]-n[a][m.num][n[a][m.num].length-1][0],2)+Math.pow(n[a][m.num][0][1]-
n[a][m.num][n[a][m.num].length-1][1],2)&&(0==m.subnum?(n[a][m.num][n[a][m.num].length-1][0]=n[a][m.num][0][0],n[a][m.num][n[a][m.num].length-1][1]=n[a][m.num][0][1]):(n[a][m.num][0][0]=n[a][m.num][n[a][m.num].length-1][0],n[a][m.num][0][1]=n[a][m.num][n[a][m.num].length-1][1]),q=null,B()),m=null):(1==fa[a]&&(c.y=g[a].imgheight/2),1==m.mode?F[a].splice(m.num,1):2==m.mode?C[a].splice(m.num,1):.5==m.mode?n[a].splice(m.num,1):0==m.mode?n[a][m.num][m.subnum]=wa:5<=m.mode&&10>m.mode?(d[a].splice(m.num,
1),u=null):10<=m.mode&&11>m.mode&&(l[a].splice(m.num,1),A=null),m=null,B()));ca=!1;I?Pa=window.setTimeout(function(){I=!1;va();v(document).on("mousemove.imathasdraw",da);v(".drawcanvas").on("touchstart.imathasdraw",function(a){I=!0;ba(a)});v(document).on("mousedown.imathasdraw",ba)},350):(va(),v(document).on("mousemove.imathasdraw",da),v(".drawcanvas").on("touchstart.imathasdraw",function(a){I=!0;ba(a)}),v(document).on("mousedown.imathasdraw",ba))}function da(h){var k=null;Fa=!1;var e=Ea(h);for(i in g){var c=
M(g[i].el);if(c.x<e.x&&c.x+g[i].width>e.x&&c.y<e.y&&c.y+g[i].height>e.y){k=i;break}}null!=k&&(c=M(g[k].el),c={x:e.x-c.x,y:e.y-c.y},0<g[k].snaptogridx&&(c=na(c,k)),1==fa[k]&&(c.y=g[k].imgheight/2),-1<c.x&&c.x<g[k].width&&-1<c.y&&c.y<g[k].height&&null==m&&null==q&&(c=oa(k,c),g[k].el.style.cursor=null==c?"url("+imasroot+"/img/pen.cur), default":"move"));if(null!=a){if(h.originalEvent.touches&&1<h.originalEvent.touches.length)return ca=!0;"undefined"!=typeof h&&h.preventDefault();c=M(g[a].el);c={x:e.x-
c.x,y:e.y-c.y};0<g[a].snaptogridx&&(c=na(c,a));1==fa[a]&&(c.y=g[a].imgheight/2);if(-1<c.x&&c.x<g[a].width&&-1<c.y&&c.y<g[a].height)return null==m?null!=q?!Q||0!=g[a].mode&&.7!=g[a].mode?Q&&.5==g[a].mode?(h=n[a][q].length-1,0==h?(h=Math.pow(n[a][q][h][0]-c.x,2)+Math.pow(n[a][q][h][1]-c.y,2),25<h?(n[a][q].push([c.x,c.y]),B()):B(c.x,c.y)):(n[a][q][h]=[c.x,c.y],B())):B(c.x,c.y):(h=n[a][q].length-1,h=Math.pow(n[a][q][h][0]-c.x,2)+Math.pow(n[a][q][h][1]-c.y,2),25<h?(n[a][q].push([c.x,c.y]),B()):B(c.x,c.y)):
null!=u?Q?B():B(c.x,c.y):null!=A?Q?B():B(c.x,c.y):(c=oa(a,c),g[a].el.style.cursor=null==c?"url("+imasroot+"/img/pen.cur), default":"move"):(g[a].el.style.cursor="move",0==m.mode||.5==m.mode?n[a][m.num][m.subnum]=[c.x,c.y]:1==m.mode?F[a][m.num]=[c.x,c.y]:2==m.mode?C[a][m.num]=[c.x,c.y]:5<=m.mode&&10>m.mode?d[a][m.num][m.subnum]=[c.x,c.y]:10<=m.mode&&11>m.mode&&(l[a][m.num][m.subnum]=[c.x,c.y]),B()),!1}}function Ea(a){a=a||window.event;if(I)return a=a.originalEvent.changedTouches[0]||a.originalEvent.touches[0],
{x:a.pageX,y:a.pageY};if(a.pageX||a.pageY)return{x:a.pageX,y:a.pageY};var d=document.documentElement;var e=document.body;if(d&&(d.scrollTop||d.scrollLeft)){var c=d.scrollLeft;d=d.scrollTop}else e?(c=e.scrollLeft,d=e.scrollTop):d=c=0;return{x:a.clientX+c,y:a.clientY+d}}function na(a,d){var e=a.x-g[d].imgborder+g[d].xmin*g[d].pixperx,c=a.y-g[d].imgborder-g[d].ymax*g[d].pixpery;e=Math.round(Math.round(e/(g[d].pixperx*g[d].snaptogridx))*g[d].pixperx*g[d].snaptogridx+g[d].imgborder-g[d].xmin*g[d].pixperx);
c=Math.round(Math.round(c/(g[d].pixpery*g[d].snaptogridy))*g[d].pixpery*g[d].snaptogridy+g[d].imgborder+g[d].ymax*g[d].pixpery);return{x:e,y:c}}function ab(a,d){var e=M(a),c=Ea(d);return{x:c.x-e.x,y:c.y-e.y}}function M(a){for(var d=0,e=0;a.offsetParent;)d+=a.offsetLeft,e+=a.offsetTop,a=a.offsetParent;d+=a.offsetLeft;e+=a.offsetTop;return{x:d,y:e}}function va(){v(document).off("mousedown.imathasdraw").off("mousemove.imathasdraw").off("mouseup.imathasdraw");v(document).off("touchstart.imathasdraw").off("touchmove.imathasdraw").off("touchend.imathasdraw").off("touchcancel.imathasdraw");
v(".drawcanvas").off("touchstart.imathasdraw").off("touchmove.imathasdraw").off("touchend.imathasdraw").off("touchcancel.imathasdraw")}function ya(h){va();v(".drawcanvas").on("mousemove.imathasdraw",da);v(".drawcanvas").on("touchstart.imathasdraw",function(a){I=!0;ba(a)});v(document).on("mousedown.imathasdraw",ba);try{CanvasRenderingContext2D.prototype.dashedLine=function(c,e,b,d,h){void 0==h&&(h=10);this.beginPath();this.moveTo(c,e);var f=b-c,k=d-e;h=Math.sqrt(f*f+k*k)/h;f/=h;k/=h;h=Math.floor(h);
for(var l=0;l++<h&&-1<e&&e<g[a].imgheight+1&&-1<c&&c<g[a].imgwidth+1;)c+=f,e+=k,this[0==l%2?"moveTo":"lineTo"](c,e);this[0==l%2?"moveTo":"lineTo"](b,d);this.stroke();this.closePath()}}catch(E){}for(var k in canvases)if("undefined"==typeof h||h==k){var e=null;if(null!=drawla[k]&&2<drawla[k].length){n[canvases[k][0]]=drawla[k][0];F[canvases[k][0]]=drawla[k][1];C[canvases[k][0]]=drawla[k][2];y[canvases[k][0]]=[];d[canvases[k][0]]=[];if(3<drawla[k].length&&0<drawla[k][3].length)for(var c=0;c<drawla[k][3].length;c++)y[canvases[k][0]][c]=
drawla[k][3][c][0],d[canvases[k][0]][c]=[drawla[k][3][c].slice(1,3),drawla[k][3][c].slice(3)];L[canvases[k][0]]=[];l[canvases[k][0]]=[];if(4<drawla[k].length&&0<drawla[k][4].length)for(c=0;c<drawla[k][4].length;c++)L[canvases[k][0]][c]=drawla[k][4][c][0],l[canvases[k][0]][c]=[drawla[k][4][c].slice(1,3),drawla[k][4][c].slice(3,5),drawla[k][4][c].slice(5)];5<drawla[k].length&&(e=drawla[k][5])}"a11ydraw"==canvases[k][1].substr(0,8)?rb(canvases[k],e):sb(canvases[k][0],"canvas"+canvases[k][0],imasroot+
"/filter/graph/imgs/"+canvases[k][1],"qn"+canvases[k][0],canvases[k][2],canvases[k][3],canvases[k][4],canvases[k][5],canvases[k][6],canvases[k][7],canvases[k][8],canvases[k][9],canvases[k][10],canvases[k][11],canvases[k][12])}}function Qa(a){for(var d,e=0;e<w.idnums.length;e++)if("undefined"==typeof a||a==w.idnums[e]){d=w.idnums[e];var c,h=d;var f=document.getElementById("qn"+h).value;if(c=f.match(/\(-oo,([\-\d\.]+)\)U\(([\-\d\.]+),oo\)/)){var b=3;f=c[1];c=c[2]}else(c=f.match(/\(-oo,([\-\d\.]+)\)/))?
(b=0,f=c[1],c=2.5):(c=f.match(/\(([\-\d\.]+),oo\)/))?(b=1,f=c[1],c=2.5):(c=f.match(/\(([\-\d\.]+),([\-\d\.]+)\)/))?(b=2,f=c[1],c=c[2]):(b=0,f=-1.5,c=2.5);document.getElementById("slid1"+h).style.left=60*f+250-6+"px";document.getElementById("slid2"+h).style.left=60*c+250-6+"px";document.getElementById("shaderegions"+h).selectedIndex=b;w.curslider.type=document.getElementById("shaderegions"+h).value;bb(h);v("#slid1"+d).on("touchstart.normslider mousedown.normslider",Ra);v("#slid2"+d).on("touchstart.normslider mousedown.normslider",
Ra)}}function Ra(a){a=a||window.event;a.originalEvent.touches&&0<a.originalEvent.touches.length?(I=!0,v(document).on("touchmove.normslider",Sa),v(document).on("touchend.normslider",Ta)):(v(document).on("mousemove.normslider",Sa),v(document).on("mouseup.normslider",Ta));w.curslider.el=a.target||a.srcElement;w.curslider.id=w.curslider.el.id.substring(5);w.curslider.type=document.getElementById("shaderegions"+w.curslider.id).value;w.curslider.outnode=document.getElementById(w.outputid);w.curslider.startpos=
ab(w.curslider.el,a);w.curslider.el.parentNode.style.cursor="pointer";M(w.curslider.el.parentNode);a.preventDefault&&a.preventDefault();return!1}function Sa(a){var d=w.curslider.id;a=a||window.event;var e=ab(w.curslider.el.parentNode,a);if(!(5>e.x||e.x>w.curslider.el.parentNode.offsetWidth-5||5>e.y||e.y>w.curslider.el.parentNode.offsetHeight-5))return w.curslider.el.style.left=6*Math.round((e.x-w.curslider.startpos.x-10)/6)+10+"px",Ua(d),a.preventDefault&&a.preventDefault(),!1}function Ta(a){null!==
w.curslider.el&&(I=!1,v(document).off("touchmove.normslider touchend.normslider"),v(document).off("mousemove.normslider mouseup.normslider"),w.curslider.el.parentNode.style.cursor="",w.curslider.el=null)}function Ua(a){var d,e=parseInt(document.getElementById("slid1"+a).style.left)+6,c=parseInt(document.getElementById("slid2"+a).style.left)+6,g=Math.min(e,c),f=Math.max(e,c);"2O"==w.curslider.type?document.getElementById("normleft"+a).style.width=g+1+"px":"1L"==w.curslider.type?document.getElementById("normleft"+
a).style.width=e+1+"px":"2B"==w.curslider.type&&(document.getElementById("normleft"+a).style.left=g+"px",document.getElementById("normleft"+a).style.width=f-g+1+"px");"2O"==w.curslider.type?document.getElementById("normright"+a).style.width=500-f+"px":"1R"==w.curslider.type&&(document.getElementById("normright"+a).style.width=500-e+"px");g=(-4+(e-10)/60).toFixed(1);f=(-4+(c-10)/60).toFixed(1);var b=document.getElementById("slid1txt"+a);b.innerHTML=g;b.style.left=e-6+"px";e=document.getElementById("slid2txt"+
a);e.innerHTML=f;e.style.left=c-6+"px";c=Math.min(g,f);e=Math.max(g,f);"2O"==w.curslider.type?d="(-oo,"+c+")U("+e+",oo)":"2B"==w.curslider.type?d="("+c+","+e+")":"1L"==w.curslider.type?d="(-oo,"+g+")":"1R"==w.curslider.type&&(d="("+g+",oo)");document.getElementById("qn"+a).value=d}function bb(a){var d=document.getElementById("shaderegions"+a).value;w.curslider.type=d;var e=parseInt(document.getElementById("slid1"+a).style.left)+6,c=parseInt(document.getElementById("slid2"+a).style.left)+6,g=Math.min(e,
c);c=Math.max(e,c);"1R"==d||"1L"==d?(document.getElementById("slid2"+a).style.display="none",document.getElementById("slid2txt"+a).style.display="none","1R"==d?(document.getElementById("normleft"+a).style.display="none",document.getElementById("normright"+a).style.display="",document.getElementById("normright"+a).style.right="0px",document.getElementById("normright"+a).style.width=500-e+"px"):(document.getElementById("normright"+a).style.display="none",document.getElementById("normleft"+a).style.display=
"",document.getElementById("normleft"+a).style.left="0px",document.getElementById("normleft"+a).style.width=e+"px")):"2O"==d?(document.getElementById("slid2"+a).style.display="",document.getElementById("slid2txt"+a).style.display="",document.getElementById("normleft"+a).style.display="",document.getElementById("normright"+a).style.display="",document.getElementById("normright"+a).style.right="0px",document.getElementById("normleft"+a).style.left="0px",document.getElementById("normright"+a).style.width=
500-c+"px",document.getElementById("normleft"+a).style.width=g+"px"):"2B"==d&&(document.getElementById("slid2"+a).style.display="",document.getElementById("slid2txt"+a).style.display="",document.getElementById("normleft"+a).style.display="",document.getElementById("normright"+a).style.display="none",document.getElementById("normleft"+a).style.left=g+"px",document.getElementById("normleft"+a).style.width=c-g+"px");Ua(a)}var Q=!1,g=[],Wa=[],Va=[],ra=[],n=[],F=[],C=[],d=[],y=[],l=[],L=[],q=null,Ga=[],
fa=[],u=null,A=null,kb=["rgb(0,0,255)","rgb(255,0,0)","rgb(0,255,0)"],ub=["rgba(0,0,255,.4)","rgba(255,0,0,.4)","rgba(0,255,0,.4)"],m=null,wa=null,a=null,jb=!1,I=!1,ca=!1,Fa=!1,Pa=null,vb=0,xa=null;"undefined"!=typeof initstack?initstack.push(ya):v(function(){ya()});var w={idnums:[],curslider:{el:null,startpos:[0,0],outnode:null}};"undefined"!=typeof initstack&&initstack.push(Qa);return{initCanvases:ya,clearcanvas:function(g){n[g].length=0;F[g].length=0;C[g].length=0;d[g].length=0;y[g].length=0;l[g].length=
0;L[g].length=0;a=g;B();m=q=a=null},settool:function(d,k,e){for(var c=document.getElementById("drawtools"+k),h=c.getElementsByTagName("span"),f=0;f<h.length;f++)h[f].className="";h=c.getElementsByTagName("img");for(f=0;f<h.length;f++)h[f].className="";d.className="sel";g[k].mode=e;a=k;B()},addnormslider:function(a){-1==arraysearch(a,w.idnums)?w.idnums.push(a):Qa(a)},chgnormtype:bb,adda11ydraw:O,changea11ydraw:function(a,d){var e=v(a).val();e=g[d].moderef[e];v(a).parent().find(".a11ydrawinstr").text(e.input)},
encodea11ydraw:function(){for(var a=0;a<ra.length;a++){var d=ra[a],e=g[d],c=[],l=[],f=[],b=[],m=[],n=[];v("#a11ydraw"+d).find(".a11ydrawrow").each(function(a,d){var g=v(d).find("select").val(),h=v(d).find("input").val();n.push("["+g+',"'+h+'"]');h=h.replace(/[\(\)]/g,"").split(/\s*,\s*/);var k=[];for(a=1;a<h.length;a+=2){try{h[a-1]=eval(prepWithMath(mathjs(h[a-1])))}catch(tb){h[a-1]=NaN}try{h[a]=eval(prepWithMath(mathjs(h[a])))}catch(tb){h[a]=NaN}h[a-1]=(h[a-1]-e.xmin)*e.pixperx+e.imgborder;h[a]=
e.imgheight-(h[a]-e.ymin)*e.pixpery-e.imgborder;k.push(Math.round(h[a-1])+","+Math.round(h[a]))}1==g?l.push("("+k.join("),(")+")"):2==g?f.push("("+k.join("),(")+")"):1>g?c.push("("+k.join("),(")+")"):5<=g&&10>g&&2==k.length?b.push("("+g+","+k.join(",")+")"):10<=g&&3==k.length&&m.push("("+g+","+k.join(",")+")")});Va[d].value=c.join(";")+";;"+l.join(",")+";;"+f.join(",")+";;"+b.join(",")+";;"+m.join(",")+";;"+n.join(",")}},removea11ydraw:function(a){v(a).parent().remove()}}}(jQuery);

var ehcurel=null,ehclosetimer=0,ehddclosetimer=0,curehdd=null,eecurel=null;function showeh(a){if(null==eecurel){unhideeh(0);var c=document.getElementById(a),b=document.getElementById("eh");a!=ehcurel?(ehcurel=a,a=findPos(c),b.style.display="block",b.style.left=a[0]+"px",b.style.top=a[1]+c.offsetHeight+"px"):(b.style.display="none",ehcurel=null);c.focus()}}
function reshrinkeh(a){null==eecurel&&a==ehcurel&&(document.getElementById("ehdd").style.display="block",document.getElementById("eh").style.display="none",ehcurel=null,curehdd=a,unhideeh(0))}function unhideeh(a){ehcancelclosetimer()}function hideeh(a){null==ehcurel?ehddclosetimer=window.setTimeout(function(){curehdd=null;document.getElementById("ehdd").style.display="none"},250):ehclosetimer=window.setTimeout(reallyhideeh,250)}
function reallyhideeh(){document.getElementById("eh").style.display="none";ehcurel=null}function ehcancelclosetimer(){ehclosetimer&&(window.clearTimeout(ehclosetimer),ehclosetimer=null)}
function showehdd(a,c,b){if((null==eecurel||eecurel!=a)&&null!=document.getElementById("tips"+b)){ehddclosetimer&&a!=curehdd&&(window.clearTimeout(ehddclosetimer),ehddclosetimer=null);if(a!=ehcurel){var d=document.getElementById("ehdd"),e=document.getElementById(a),f=findPos(e);document.getElementById("ehddtext").innerHTML=c;document.getElementById("eh").innerHTML=document.getElementById("tips"+b).innerHTML;d.style.display="block";d.style.left=f[0]+"px";d.style.top=f[1]+e.offsetHeight+"px"}curehdd=
a}}function updateehpos(){if(curehdd||ehcurel){var a=document.getElementById("eh"),c=document.getElementById("ehdd"),b=document.getElementById(curehdd||ehcurel),d=findPos(b);a.style.left=d[0]+"px";a.style.top=d[1]+b.offsetHeight+"px";c.style.left=d[0]+"px";c.style.top=d[1]+b.offsetHeight+"px"}};
